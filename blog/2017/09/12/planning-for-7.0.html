<!DOCTYPE html><html lang="zh-CN" class="no-js"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Planning for 7.0 | Babel中文网</title><meta name="description" content="If you didn’t know already, we’re planning on releasing a 7.0 version soon 🙌 ! Work on it actually started back in February, when I just wanted to make a rel..."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /><link rel="stylesheet" href="/css/main.css?t=2018-09-18T02:18:06+00:00"><link rel="canonical" href="https://babeljs.cn/blog/2017/09/12/planning-for-7.0.html"><link rel="alternate" type="application/rss+xml" title="Babel" href="https://babeljs.cn/feed.xml" /><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="og:url" content="https://babeljs.cn"><meta name="og:image" content="website"><meta name="og:title" content="Planning for 7.0 | Babel中文网"><meta name="og:description" content="If you didn’t know already, we’re planning on releasing a 7.0 version soon 🙌 ! Work on it actually started back in February, when I just wanted to make a rel..."><meta name="og:image" content="https://babeljs.cn/images/share-image.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@babeljs"><meta name="twitter:title" content="Planning for 7.0 | Babel中文网"><meta name="twitter:description" content="If you didn’t know already, we’re planning on releasing a 7.0 version soon 🙌 ! Work on it actually started back in February, when I just wanted to make a rel..."><meta name="twitter:image:src" content="https://babeljs.cn/images/share-image.png"><meta name="twitter:url" content="https://babeljs.cn/blog/2017/09/12/planning-for-7.0.html"> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?7d7e96af885ecd66a8c4ac73dc983681"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script></head><input type="checkbox" id="babel-toggle-search" class="babel-toggle-search-checkbox" /><header class="navbar navbar-default navbar-fixed-top babel-nav" id="top" role="banner"><div class="container"> <a href="/" class="navbar-brand logo">Babel</a><div class="babel-navbar-toggles"><div class="navbar-header"> <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#babel-navbar" aria-controls="babel-navbar" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label></div></div><nav id="babel-navbar" class="collapse navbar-collapse babel-navbar"><ul class="nav navbar-nav"><li > <a href="/learn-es2015/">学习 ES2015</a></li><li class="dropdown "> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">文档 <span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li > <a href="/docs/setup/">配置</a></li><li > <a href="/docs/editors.html">编辑器</a></li><li > <a href="/docs/usage/caveats/">注意事项</a></li><li > <a href="/docs/community/videos/">视频</a></li><li class="group-name">相关依赖</li><li > <a href="/docs/core-packages/">babel-core</a></li><li > <a href="/docs/usage/polyfill/">babel-polyfill</a></li><li > <a href="/docs/plugins/">Plugins</a></li><li class="group-name">使用方式</li><li > <a href="/docs/usage/babelrc/">.babelrc</a></li><li > <a href="/docs/usage/cli/">babel-cli</a></li><li > <a href="/docs/usage/babel-register/">babel-register</a></li><li > <a href="/docs/usage/api/">API</a></li></ul></li><li > <a href="/repl/">试用</a></li><li class="active"> <a href="/blog/">Blog</a></li><li > <a href="/faq">常见问题</a></li><li > <a href="/team">团队</a></li><li > <a href="https://docschina.org/">印记中文</a></li><li > <a href="https://babel.docschina.org/">Babel V7</a></li></ul><ul class="nav navbar-nav navbar-right nav-social"><li> <a href="https://opencollective.com/babel">赞助</a></li><li> <a href="https://slack.babeljs.io/" title="Join us on Slack"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect x="219.27" y="221.3" width="72.04" height="69.58" transform="translate(-67.42 94.64) rotate(-18.52)"/><path d="M489.84,185.3C437,9.29,360.9-31.64,184.9,21.16S-32,150.1,20.76,326.1,149.7,543,325.7,490.24,542.64,361.3,489.84,185.3ZM401,299.5l-33.15,11.05,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18l-11.46-34.38-68.36,22.92,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18L198.81,367l-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18c-4.5-13.92,2.87-29.06,16.78-33.56L182,316.69l-22.1-65.9-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18C88.71,231.14,96.08,216,110,211.49l33.15-11.05-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78l11.46,34.38,68.36-22.92-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78L312.2,144l33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78s-2.87,29.06-16.78,33.56L329,194.3l22.1,65.9,33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78S414.93,295,401,299.5Z" transform="translate(0.7 0.3)"/></svg> </a></li><li> <a href="https://twitter.com/babeljs" title="Follow us on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 416.32"><title>twitter</title><path d="M160.83,464.16c193.2,0,298.92-160.22,298.92-298.92,0-4.51,0-9-.2-13.52A214,214,0,0,0,512,97.22a212.93,212.93,0,0,1-60.44,16.6,105.7,105.7,0,0,0,46.3-58.19A209,209,0,0,1,431.07,81a105.09,105.09,0,0,0-181.73,71.91,116.12,116.12,0,0,0,2.66,24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48,105.48,0,0,0,68,207.44a106.27,106.27,0,0,1-47.53-13.11v1.43a105.28,105.28,0,0,0,84.21,103.06,105.67,105.67,0,0,1-47.33,1.84,105.06,105.06,0,0,0,98.14,72.94A210.72,210.72,0,0,1,25,418.68a202.17,202.17,0,0,1-25-1.43,298.85,298.85,0,0,0,160.83,46.92" transform="translate(0 -47.84)" fill="#010101"/></svg> </a></li><li> <a href="https://github.com/babel/babel" title="Contribute on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36"><path d="M256,6.32c-141.36,0-256,114.61-256,256,0,113.09,73.34,209,175.08,242.9,12.8,2.35,17.47-5.56,17.47-12.34,0-6.08-.22-22.18-.35-43.54C121,464.83,106,415,106,415c-11.64-29.57-28.42-37.45-28.42-37.45C54.31,361.71,79.31,362,79.31,362c25.69,1.81,39.21,26.38,39.21,26.38,22.84,39.12,59.92,27.82,74.5,21.27,2.33-16.54,8.94-27.82,16.25-34.22C152.43,369,92.67,347,92.67,248.94c0-27.95,10-50.8,26.35-68.69-2.63-6.48-11.42-32.5,2.51-67.75,0,0,21.49-6.88,70.4,26.24a242.65,242.65,0,0,1,128.18,0c48.87-33.13,70.33-26.24,70.33-26.24,14,35.25,5.18,61.27,2.55,67.75,16.41,17.9,26.31,40.75,26.31,68.69,0,98.35-59.85,120-116.88,126.32,9.19,7.9,17.38,23.53,17.38,47.41,0,34.22-.31,61.83-.31,70.23,0,6.85,4.61,14.81,17.6,12.31C438.72,471.29,512,375.4,512,262.34,512,120.94,397.37,6.32,256,6.32Z" transform="translate(0 -6.32)" fill="#191717" fill-rule="evenodd"/></svg> </a></li></ul><label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">打开搜索</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label><div class="navbar-form navbar-right babel-search" role="search"><div class="input-group"> <label class="sr-only" aria-label="Search" for="babel-search-input">搜索</label><div class="babel-search-input-wrapper"> <input type="text" class="form-control" id="babel-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="在文档中搜索..."> <label for="babel-toggle-search" class="babel-toggle-search-close"> <span class="sr-only">关闭搜索</span> <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span> </label></div></div></div></nav></div></header><div class="docs-header"><div class="container"><div class="row"><div class="col-md-6 col-md-push-3 text-center"><h1>Planning for 7.0</h1></div></div></div></div><div class="container"><div class="row"><div class="col-md-8 col-md-push-2 babel-blog-content"><p class="small text-center text-muted">Posted Sep 12, 2017 by <a href="https://twitter.com/left_pad">Henry Zhu</a></p><p>If you didn’t know already, we’re planning on releasing a 7.0 version soon 🙌 ! Work on it actually started back in February, when I just wanted to make a release to drop Node 0.10/0.12 support and remove babel-runtime and various other code. And since then, we’ve done releases up to <code class="highlighter-rouge">alpha.20</code>.</p><blockquote><p>We’re going to update this post throughout the beta releases</p></blockquote><p>Since we’re still just a volunteer project, it’s been difficult for most of the team to stay focused and motivated to make all these changes and continue to maintain a project that so many companies, bootcamps, and tools rely on so much. But in the meantime we’ve made a lot of progress: <a href="https://github.com/babel/notes">weekly meetings/notes</a>, participating as invited guests at TC39 for the last few meetings, facilitating in both <a href="https://railsgirlssummerofcode.org/">RGSoC</a> and <a href="https://summerofcode.withgoogle.com">GSoC</a>, and creating an <a href="https://opencollective.com/babel">Open Collective</a>.</p><h2 id="upgrading">Upgrading</h2><blockquote><p>Upgrading for most projects should be as simple as updating your <code class="highlighter-rouge">package.json</code> deps to <code class="highlighter-rouge">7.0.0-beta.0</code>. For the whole time we’ve been working on 7.0, we’ve been using it in Babel itself (so meta) and at my workplace at Behance.</p></blockquote><blockquote><p>We will be pinning all dependencies to exact versions until the official release.</p></blockquote><div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nt">"babel-cli"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7.0.0-beta.0"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>Specific packages:</p><details> babel packages in the monorepo should all be &gt;= 7.0.0-beta.0 <br /> babel-preset-env should be at least 2.0.0-beta.0 <br /> babel-eslint can be &gt;= 8.0.0 <br /> babel-loader should be &gt;= 7.0.0 (out of beta since it uses babel-core as a peerDependency) <br /> grunt-babel can be &gt;= 7.0.0 <br /> gulp-babel can be &gt;= 7.0.0 <br /> rollup-plugin-babel can be &gt;= 3.0.2 </details><hr /><p>Please check out our <a href="https://babeljs.io/blog/2017/03/01/upgrade-to-babel-7">upgrade guide</a> and other guide specifically for <a href="https://babeljs.io/blog/2017/03/01/upgrade-to-babel-7-for-tool-authors">tool authors</a> which we will also be updating as necessary.</p><p>I’d like to go over some notable changes for our first beta release (it’s still a lot <em>smaller</em> in scope in terms of breaking changes than the previous 6.0 release).</p><h2 id="re-iterating-project-goals">Re-iterating Project Goals</h2><p>Before we go into that, I just want to repeat again what the purpose of Babel is.</p><p>Since Babel has been renamed from 6to5, browsers have been implementing more of the spec and users are more comfortable with using the latest syntax/build tooling. It shouldn’t be surprisingly however that Babel’s goals haven’t changed much.</p><p>Our two goals are hand in hand:</p><ol><li>Help developers transform new syntax into backwards compatible code (abstract browser support away)</li><li>Be a bridge to help TC39 get feedback on new ECMAScript proposals and for the community to have a say in the future of the language.</li></ol><p>Thus, I think it’s an understatement to say that Babel is a vital part of the JavaScript community (almost 10 million downloads a month of <code class="highlighter-rouge">babel-core</code>) and sorely needs its support. (The only talks I’ve tried to give are about this point: <a href="https://github.com/hzoo/maintaining-an-oss-project">JSConf EU</a>, <a href="https://github.com/hzoo/so-how-does-babel-even-work">React Rally</a>, <a href="https://github.com/hzoo/role-of-babel-in-js">TC39</a>). I said recently: “What happens if Babel dies”? What happens when the current group of people interested in this project get bored/burned out/move on to other things? (What if it’s already happened?). Are we going to do something about it? I don’t want to just ask you to help us, you already are <em>us</em> as users of the project.</p><p>Ok then, let’s talk about some changes!</p><h2 id="4315-drop-support-for-unmaintained-node-versions-010-012-5"><a href="https://github.com/babel/babel/issues/4315">#4315</a> Drop support for unmaintained Node versions: 0.10, 0.12, 5</h2><p>Progress in OSS projects often comes at the cost of upgrading for its users. Because of this, we’ve always been hesitant in making the choice to introduce a major version bump/breaking changes. By dropping unsupported versions of Node, we can not only make a number of improvements to the codebase, but also upgrade dependencies and tools (ESLint, Yarn, Jest, Lerna, etc).</p><h2 id="-proposal-updatesspec-compliancy">👓 Proposal Updates/Spec Compliancy</h2><blockquote><p>AKA the only things most of you care about 😅</p></blockquote><h3 id="philosophy-proposals-spec-loose-default-behavior">Philosophy (Proposals: spec, loose, default behavior)</h3><p>We’ve created a new repo: <a href="https://github.com/babel/proposals">babel/proposals</a> to track our progress on the various <a href="https://github.com/tc39/proposals">TC39 Proposals</a> and meetings.</p><p>I also added a section about <a href="https://github.com/babel/proposals#when-does-babel-implement-new-features">how we accept new proposals</a>. Our basic thinking is that we will start accepting PRs for anything a TC39 champion is going to present (Stage 0). And we will update them (with your help!) when the spec changes.</p><p>Naturally, we will take the opportunity to be as spec compliant as possible (within reasonable speed, etc) as the default behavior. This means if you need a faster/smaller build, you should use the <code class="highlighter-rouge">loose</code> option which will purposely disregard certain spec changes like runtime checks and other edge cases. The reason why it is opt-in is because we expect you should know what you are doing, while others should be able to seamlessly upgrade <code class="highlighter-rouge">babel-preset-env</code> to use the native version of each syntax or stop using Babel entirely and have no issues.</p><h3 id="stage-3-class-properties-from-stage-2">Stage 3: Class Properties (from Stage 2)</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-class-properties"><code class="highlighter-rouge">babel-plugin-transform-class-properties</code></a>: the default behavior is now what was previously the “spec” option, which uses <code class="highlighter-rouge">Object.defineProperty</code> instead of simple assignment.</p></blockquote><blockquote><p>This currently has the effect of breaking the <a href="https://github.com/loganfsmyth/babel-plugin-transform-decorators-legacy">legacy decorators plugin</a> (which we made the “transform-decorators” plugin in 7.0) if you try to decorate a class property. You’ll need to use the <code class="highlighter-rouge">loose</code> option to be compatible with the version of decorators in the transform until we release the Stage 2 decorators plugin.</p></blockquote><blockquote><p>Private fields are WIP: <a href="https://github.com/babel/babel/pull/6120">#6120</a></p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">class</span> <span class="nx">Bork</span> <span class="p">{</span>
  <span class="kr">static</span> <span class="nx">a</span> <span class="o">=</span> <span class="s1">'foo'</span><span class="p">;</span>
  <span class="nx">x</span> <span class="o">=</span> <span class="s1">'bar'</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>Output (default)</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">class</span> <span class="nx">Bork</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s2">"x"</span><span class="p">,</span> <span class="p">{</span>
      <span class="na">configurable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">enumerable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">writable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="na">value</span><span class="p">:</span> <span class="s1">'bar'</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>

<span class="nb">Object</span><span class="p">.</span><span class="nx">defineProperty</span><span class="p">(</span><span class="nx">Bork</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">configurable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">enumerable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">writable</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">value</span><span class="p">:</span> <span class="s1">'foo'</span>
<span class="p">});</span>
</code></pre></div><p>Output (loose mode)</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">class</span> <span class="nx">Bork</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="s1">'bar'</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="nx">Bork</span><span class="p">.</span><span class="nx">a</span> <span class="o">=</span> <span class="s1">'foo'</span><span class="p">;</span>
</code></pre></div><h3 id="stage-3-object-rest-spread-from-stage-2">Stage 3: Object Rest Spread (from Stage 2)</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-object-rest-spread"><code class="highlighter-rouge">babel-plugin-transform-object-rest-spread</code></a>: And now the plugin handles non-string keys (ex: Number/Symbol)</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// Rest Properties</span>
<span class="kd">let</span> <span class="p">{</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="p">...</span><span class="nx">z</span> <span class="p">}</span> <span class="o">=</span> <span class="p">{</span> <span class="na">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="na">y</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="na">a</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="na">b</span><span class="p">:</span> <span class="mi">4</span> <span class="p">};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// 1</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// 2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">z</span><span class="p">);</span> <span class="c1">// { a: 3, b: 4 }</span>

<span class="c1">// Spread Properties</span>
<span class="kd">let</span> <span class="nx">n</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="p">...</span><span class="nx">z</span> <span class="p">};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span> <span class="c1">// { x: 1, y: 2, a: 3, b: 4 }</span>
</code></pre></div><p>Also disallowed</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="p">{</span> <span class="p">...{</span> <span class="nx">x</span> <span class="p">}</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
<span class="kd">var</span> <span class="p">{</span> <span class="p">...[</span> <span class="nx">y</span> <span class="p">]</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">;</span>
</code></pre></div><h3 id="stage-3-optional-catch-binding-new">Stage 3: Optional Catch Binding (new)</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-optional-catch-binding"><code class="highlighter-rouge">babel-plugin-transform-optional-catch-binding</code></a>: allow developers to use try/catch without creating an unused binding.</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span>
  <span class="k">throw</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">{</span>
  <span class="nx">doSomethingWhichDoesntCareAboutTheValueThrown</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="k">try</span> <span class="p">{</span>
  <span class="k">throw</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">_unused</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">doSomethingWhichDoesntCareAboutTheValueThrown</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div><h3 id="stage-3-unicode-property-regex-new">Stage 3: Unicode Property Regex (new)</h3><blockquote><p><a href="https://github.com/mathiasbynens/babel-plugin-transform-unicode-property-regex"><code class="highlighter-rouge">babel-plugin-transform-unicode-property-regex</code></a>: compile Unicode property escapes (<code class="highlighter-rouge">\p{…}</code> and <code class="highlighter-rouge">\P{…}</code>) in Unicode regular expressions to ES5 or ES6 that works in today’s environments.</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">regex</span> <span class="o">=</span> <span class="sr">/</span><span class="se">\p</span><span class="sr">{ASCII_Hex_Digit}/</span><span class="nx">u</span><span class="p">;</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">regex</span> <span class="o">=</span> <span class="sr">/</span><span class="se">[</span><span class="sr">0-9A-Fa-f</span><span class="se">]</span><span class="sr">/</span><span class="p">;</span>
</code></pre></div><h3 id="stage-3-bigint-new-unfinished">Stage 3: BigInt (new, unfinished)</h3><blockquote><p><code class="highlighter-rouge">babel-plugin-transform-bigint</code>: <a href="https://github.com/babel/babel/pull/6015">#6015</a>. This won’t be included in the Stage presets because it would be slow to wrap all operators.</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="mi">50000</span><span class="nx">n</span> <span class="o">+</span> <span class="mi">60</span><span class="nx">n</span><span class="p">;</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="nx">babelCheckBinaryExpressions</span> <span class="nx">from</span> <span class="s2">"babel-check-binary-expressions"</span><span class="p">;</span>
<span class="nx">babelCheckBinaryExpressions</span><span class="p">(</span><span class="k">new</span> <span class="nx">BigInt</span><span class="p">(</span><span class="s2">"50000"</span><span class="p">),</span> <span class="k">new</span> <span class="nx">BigInt</span><span class="p">(</span><span class="s2">"60"</span><span class="p">),</span> <span class="s2">"+"</span><span class="p">);</span>
</code></pre></div><h3 id="stage-3-dynamic-import-from-stage-2">Stage 3: Dynamic Import (from Stage 2)</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-syntax-dynamic-import"><code class="highlighter-rouge">babel-plugin-syntax-dynamic-import</code></a>: You only need to parse the syntax since tools like Webpack can handle the transformation in place of Babel. There is also a <a href="https://github.com/airbnb/babel-plugin-dynamic-import-node">plugin for Node</a></p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">testModule</span> <span class="o">=</span> <span class="kr">import</span><span class="p">(</span><span class="s1">'test-module'</span><span class="p">);</span>
</code></pre></div><h3 id="stage-2-importmeta-syntax-only">Stage 2: <code class="highlighter-rouge">import.meta</code> (syntax only)</h3><blockquote><p>A meta property that is only syntactically valid in modules, meant for meta-information about the currently running module provided by the host environment.</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">size</span> <span class="o">=</span> <span class="kr">import</span><span class="p">.</span><span class="nx">meta</span><span class="p">.</span><span class="nx">scriptElement</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">size</span> <span class="o">||</span> <span class="mi">300</span><span class="p">;</span>
</code></pre></div><h3 id="stage-2-numeric-seperators-new">Stage 2: Numeric Seperators (new)</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-numeric-separator"><code class="highlighter-rouge">babel-plugin-transform-numeric-separator</code></a>: make numeric literals more readable by creating a visual separation (a <code class="highlighter-rouge">_</code>) between groups of digits.</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="mi">1</span><span class="nx">_000_000_000</span>
<span class="mi">0</span><span class="nx">b1010_0001_1000_0101</span>
<span class="mh">0xA0</span><span class="nx">_B0_C0</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="mi">1000000000</span>
<span class="mi">0</span><span class="nx">b1010000110000101</span>
<span class="mh">0xA0B0C0</span>
</code></pre></div><h3 id="stage-2-decorators-from-stage-1-still-wip">Stage 2: Decorators (from Stage 1), still WIP</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-decorators"><code class="highlighter-rouge">babel-plugin-transform-decorators</code></a>: <a href="https://github.com/babel/babel/pull/6107">#6107</a></p></blockquote><p>Disallowed</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// no computed decorator keys</span>
<span class="err">@</span><span class="nx">dec</span><span class="p">[</span><span class="nx">foo</span><span class="p">]</span>
<span class="kr">class</span> <span class="nx">A</span> <span class="p">{}</span>

<span class="c1">// no parameter decorators (a separate proposal)</span>
<span class="kr">class</span> <span class="nx">Foo</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="err">@</span><span class="nx">foo</span> <span class="nx">x</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="c1">// no decorators on object methods</span>
<span class="kd">var</span> <span class="nx">o</span> <span class="o">=</span> <span class="p">{</span>
  <span class="err">@</span><span class="nx">baz</span>
  <span class="nx">foo</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="c1">// decorator cannot be attached to the export</span>
<span class="err">@</span><span class="nx">foo</span>
<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="p">{}</span>
</code></pre></div><p>Valid</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// decorators with a call expression</span>
<span class="err">@</span><span class="nx">foo</span><span class="p">(</span><span class="s1">'bar'</span><span class="p">)</span>
<span class="kr">class</span> <span class="nx">A</span> <span class="p">{</span>
  <span class="c1">// decorators on computed methods</span>
  <span class="err">@</span><span class="nx">autobind</span>
  <span class="p">[</span><span class="nx">method</span><span class="p">](</span><span class="nx">arg</span><span class="p">)</span> <span class="p">{}</span>
  <span class="c1">// decorators on generator functions</span>
  <span class="err">@</span><span class="nx">deco</span>
  <span class="o">*</span><span class="nx">gen</span><span class="p">()</span> <span class="p">{}</span>
  <span class="c1">// decorators with a member expression</span>
  <span class="err">@</span><span class="nx">a</span><span class="p">.</span><span class="nx">b</span><span class="p">.</span><span class="nx">c</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span>
  <span class="nx">m</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="c1">// exported decorator classes</span>
<span class="kr">export</span> <span class="k">default</span> <span class="err">@</span><span class="nx">foo</span> <span class="kr">class</span> <span class="p">{}</span>
</code></pre></div><p>Unsupported (WIP)</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// decorated class properties</span>
<span class="kr">class</span> <span class="nx">A</span> <span class="p">{</span>
  <span class="err">@</span><span class="nx">dec</span> <span class="nx">name</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">}</span>
</code></pre></div><h3 id="stage-2-functionsent-new">Stage 2: <code class="highlighter-rouge">function.sent</code> (new)</h3><blockquote><p><a href="https://www.npmjs.com/package/babel-plugin-transform-function-sent"><code class="highlighter-rouge">babel-plugin-transform-function-sent</code></a>: compile the <code class="highlighter-rouge">function.sent</code> meta property, used inside generator functions</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">function</span><span class="o">*</span> <span class="nx">generator</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Sent"</span><span class="p">,</span> <span class="kd">function</span><span class="p">.</span><span class="nx">sent</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Yield"</span><span class="p">,</span> <span class="k">yield</span><span class="p">);</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">iterator</span> <span class="o">=</span> <span class="nx">generator</span><span class="p">();</span>
<span class="nx">iterator</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// Logs "Sent 1"</span>
<span class="nx">iterator</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="c1">// Logs "Yield 2"</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">generator</span> <span class="o">=</span> <span class="nx">_skipFirstGeneratorNext</span><span class="p">(</span><span class="kd">function</span><span class="o">*</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">_functionSent</span> <span class="o">=</span> <span class="k">yield</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Sent"</span><span class="p">,</span> <span class="nx">_functionSent</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Yield"</span><span class="p">,</span> <span class="k">yield</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div><h3 id="stage-2-export-ns-from">Stage 2: export-ns-from</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-export-namespace"><code class="highlighter-rouge">babel-plugin-transform-export-namespace</code></a>: a shorthand to import/reexport a namespace. Split out from the old <code class="highlighter-rouge">transform-export-extensions</code> which combined this proposal with another</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">export</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">ns</span> <span class="nx">from</span> <span class="s2">"mod"</span><span class="p">;</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="o">*</span> <span class="nx">as</span> <span class="nx">ns</span> <span class="nx">from</span> <span class="s2">"mod"</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span><span class="nx">ns</span><span class="p">};</span>
</code></pre></div><h3 id="stage-1-export-default-from">Stage 1: export-default-from</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-export-default"><code class="highlighter-rouge">babel-plugin-transform-export-default</code></a>: a shorthand to import/reexport something. Split out from the old <code class="highlighter-rouge">transform-export-extensions</code> which combined this proposal with another</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">export</span> <span class="nx">v</span> <span class="nx">from</span> <span class="s2">"mod"</span><span class="p">;</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="nx">_v</span> <span class="nx">from</span> <span class="s2">"module"</span><span class="p">;</span>
<span class="kr">export</span> <span class="p">{</span> <span class="nx">_v</span> <span class="nx">as</span> <span class="nx">v</span> <span class="p">};</span>
</code></pre></div><h3 id="stage-1-optional-chaining-new">Stage 1: Optional Chaining (new)</h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-optional-chaining"><code class="highlighter-rouge">babel-plugin-transform-optional-chaining</code></a>: the operator (<code class="highlighter-rouge">?.</code>) allows you to handle properties of deeply nested objects without worrying about undefined intermediate objects.</p></blockquote><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">a</span><span class="p">?.</span><span class="nx">b</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">_a</span><span class="p">;</span>
<span class="p">(</span><span class="nx">_a</span> <span class="o">=</span> <span class="nx">a</span><span class="p">)</span> <span class="o">==</span> <span class="kc">null</span> <span class="p">?</span> <span class="k">void</span> <span class="mi">0</span> <span class="p">:</span> <span class="nx">_a</span><span class="p">.</span><span class="nx">b</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
</code></pre></div><h3 id="es2015-newtarget">ES2015: <code class="highlighter-rouge">new.target</code></h3><blockquote><p><a href="https://github.com/babel/babel/tree/master/packages/babel-plugin-transform-new-target"><code class="highlighter-rouge">babel-plugin-transform-new-target</code></a>: we never got around to implementing <code class="highlighter-rouge">new.target</code> support earlier, so now there is a plugin for it that will be included in the ES2015/env presets.</p></blockquote><p>Example</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// with a function</span>
<span class="kd">function</span> <span class="nx">Foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">Foo</span><span class="p">();</span> <span class="c1">// =&gt; undefined</span>
<span class="k">new</span> <span class="nx">Foo</span><span class="p">();</span> <span class="c1">// =&gt; Foo</span>

<span class="c1">// with classes</span>
<span class="kr">class</span> <span class="nx">Foo</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span><span class="p">.</span><span class="nx">target</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">Bar</span> <span class="kr">extends</span> <span class="nx">Foo</span> <span class="p">{</span>
<span class="p">}</span>

<span class="k">new</span> <span class="nx">Foo</span><span class="p">();</span> <span class="c1">// =&gt; Foo</span>
<span class="k">new</span> <span class="nx">Bar</span><span class="p">();</span> <span class="c1">// =&gt; Bar</span>
</code></pre></div><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">class</span> <span class="nx">Foo</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">new</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">new</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">class</span> <span class="nx">Foo</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">constructor</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="nx">test</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="-new-feature">🚀 New Feature</h2><h3 id="babelrcjs"><code class="highlighter-rouge">.babelrc.js</code></h3><blockquote><p><a href="https://github.com/babel/babel/issues/4630">babel/babel#4630</a></p></blockquote><p><code class="highlighter-rouge">*.js</code> configuration files are fairly common in the JavaScript ecosystem. ESLint and Webpack both allow for <code class="highlighter-rouge">.eslintrc.js</code> and <code class="highlighter-rouge">webpack.config.js</code> configuration files, respectively.</p><p>Writing configuration files in JavaScript allows for dynamic configuration, making it possible to write a single configuration file that can adapt to different environments programmatically.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">env</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BABEL_ENV</span> <span class="o">||</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">plugins</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">env</span> <span class="o">===</span> <span class="s1">'production'</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">plugins</span><span class="p">.</span><span class="nx">push</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">plugins</span><span class="p">,</span> <span class="p">[</span><span class="s2">"a-super-cool-babel-plugin"</span><span class="p">]);</span>
<span class="p">}</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">plugins</span> <span class="p">};</span>
</code></pre></div><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">env</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BABEL_ENV</span> <span class="o">||</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span><span class="p">;</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">env</span> <span class="o">===</span> <span class="s1">'production'</span> <span class="o">&amp;&amp;</span> <span class="s2">"another-super-cool-babel-plugin"</span>
  <span class="p">].</span><span class="nx">filter</span><span class="p">(</span><span class="nb">Boolean</span><span class="p">)</span>
<span class="p">};</span>
</code></pre></div><p>This was previously done through the <code class="highlighter-rouge">env</code> configuration option, which is now deprecated. See <a href="#deprecate-the-env-option-in-babelrc">below</a> for more details.</p><h3 id="typescript">TypeScript</h3><p>You can now use <code class="highlighter-rouge">babel-preset-typescript</code> to allow Babel to strip types similar to how <code class="highlighter-rouge">babel-preset-flow</code> works!</p><div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"presets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"typescript"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>We’re working on a guide for how to setup TypeScript and Babel with the TypeScript team, which should be finished before the official 7.0 release. TL;DR is that you setup TS with <code class="highlighter-rouge">--no-emit</code> or use it in the editor/watch mode so that you can use preset-env and other Babel plugins.</p><h3 id="pure-annotation-in-specific-transforms-for-minifiers">“Pure” Annotation in specific transforms for minifiers</h3><p>After <a href="https://github.com/babel/babel/pull/6209">#6209</a>, ES6 classes that are transpiled will have a <code class="highlighter-rouge">/*#__PURE__*/</code> comment that minfiers like Uglify and babel-minify can use for dead code elimination. These annotations may expand to our helper functions as well.</p><p>Input</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">class</span> <span class="nx">C</span> <span class="p">{</span>
  <span class="nx">m</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'a'</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>Output</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">C</span> <span class="o">=</span> <span class="cm">/*#__PURE__*/</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">C</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">_classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">C</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="nx">C</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">m</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">m</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">'a'</span><span class="p">;</span>
  <span class="p">};</span>
  <span class="k">return</span> <span class="nx">C</span><span class="p">;</span>
<span class="p">}();</span>
</code></pre></div><h2 id="-other-breaking-changes">😎 Other Breaking Changes</h2><h3 id="removed-babel-preset-flow-from-babel-preset-react">Removed <code class="highlighter-rouge">babel-preset-flow</code> from <code class="highlighter-rouge">babel-preset-react</code></h3><p>This was important because we got a lot of complaints from users that weren’t using any types/flow that they ended up writing invalid JS but there was no syntax error because they used the react preset.</p><p>Also we have the TypeScript preset now, so it didn’t make sense to include <code class="highlighter-rouge">flow</code> in the react preset itself anymore.</p><h3 id="integrations">Integrations</h3><p>Packages like <code class="highlighter-rouge">grunt-babel</code>, <code class="highlighter-rouge">gulp-babel</code>, <code class="highlighter-rouge">rollup-plugin-babel</code>, etc all used to have <code class="highlighter-rouge">babel-core</code> as a dependency.</p><p>After v7, we plan to move <code class="highlighter-rouge">babel-core</code> to be a peerDependency like <code class="highlighter-rouge">babel-loader</code> has. This lets all these packages not have to bump major versions when the <code class="highlighter-rouge">babel-core</code> API hasn’t changed. Thus they are already published as <code class="highlighter-rouge">7.0.0</code> since we don’t expect any further changes to those packages.</p><h2 id="meta">Meta</h2><h3 id="5218-remove-babel-runtime-from-our-own-babel-dependencies"><a href="https://github.com/babel/babel/pull/5218">#5218</a> Remove <code class="highlighter-rouge">babel-runtime</code> from our own Babel dependencies</h3><p>Babel itself doesn’t have that many external dependencies, but in 6.x <a href="https://github.com/babel/babel/blob/958f72ddc28e2f5d02adf44eadd2b1265dd0fa4d/packages/babel-plugin-transform-es2015-arrow-functions/package.json#L12">each package has a dependency on <code class="highlighter-rouge">babel-runtime</code></a> so that built-ins like Symbol, Map, Set, and others are available without needing a polyfill. By changing the minimum supported version of Node to v4 (where those built-ins are supported natively), we can drop the dependency entirely.</p><blockquote><p>This is an issue on npm 2 (we didn’t recommended its use with Babel 6) and older yarn, but not npm 3 due to its deduping behavior.</p></blockquote><p>With <a href="https://github.com/facebookincubator/create-react-app">Create React App</a> the size of the node_modules folder changed drastically when babel-runtime was hoisted.</p><ul><li><code class="highlighter-rouge">node_modules</code> for npm 3: ~120MB</li><li><code class="highlighter-rouge">node_modules</code> for Yarn (&lt;<code class="highlighter-rouge">0.21.0</code>): ~518MB</li><li><code class="highlighter-rouge">node_modules</code> for Yarn (&lt;<code class="highlighter-rouge">0.21.0</code>) with hoisted <code class="highlighter-rouge">babel-runtime</code>: ~157MB</li><li><code class="highlighter-rouge">node_modules</code> for Yarn + <a href="https://github.com/yarnpkg/yarn/pull/2676">PR #2676</a>: ~149MB (<a href="https://twitter.com/bestander_nz/status/833696202436784128">tweet</a>)</li></ul><p>So although this issue has been fixed “upstream” by using npm &gt;= 3/later Yarn, we can do our part by simply dropping our own dependency on <code class="highlighter-rouge">babel-runtime</code>.</p><h3 id="5224-independent-publishing-of-experimental-packages"><a href="https://github.com/babel/babel/pull/5224">#5224</a> Independent Publishing of Experimental Packages</h3><blockquote><p>I mention this in <a href="http://babeljs.io/blog/2016/12/07/the-state-of-babel">The State of Babel</a> in the <code class="highlighter-rouge">Versioning</code> section. <a href="https://github.com/babel/babylon/issues/275">Github Issue</a></p></blockquote><p>You might remember that after Babel 6, Babel became a set of npm packages with its own ecosystem of custom presets and plugins.</p><p>However since then, we’ve always used a “fixed/synchronized” versioning system (so that no package is on v7.0 or above). When we do a new release such as <code class="highlighter-rouge">v6.23.0</code> only packages that have updated code in the source are published with the new version while the rest of the packages are left as is. This mostly works in practice because we use <code class="highlighter-rouge">^</code> in our packages.</p><p>Unfortunately this kind of system requires that a major version be released for all packages once a single package needs it. This either means we make a lot small breaking changes (unnecessary) or we batch lots of breaking changes into a single release. Instead, we want to differentiate between the experimental packages (Stage 0, etc) and everything else (es2015).</p><p>This means that we intend to make major version bumps to any experimental proposal plugins when the spec changes rather than waiting to update all of Babel. So anything that is &lt; Stage 4 would be open to breaking changes in the form of major version bumps and same with the Stage presets themselves if we don’t drop them entirely.</p><p>For example:</p><p>Say you are using preset-env (which keeps up to date and currently includes everything in es2015, es2016, es2017) + an experimental plugin. You also decide to use object-rest-spread because it’s cool.</p><div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"presets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"env"</span><span class="p">],</span><span class="w">
  </span><span class="nt">"plugins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"transform-object-rest-spread"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><p>If the spec to an experimental proposal changes, we should be free to make a breaking change and make a major version bump for that plugin only. Because it only affects that plugin, it doesn’t affect anything else and people are free to update when possible. We just want to make sure that users update to the latest version of any experimental proposal when possible and provide the tools to do so automatically if that is reasonable as well.</p><h3 id="todos">TODOs?</h3><blockquote><p>I believe the way we want to go about doing this is to move those packages into the <code class="highlighter-rouge">experimental/</code> folder in our <a href="https://github.com/babel/babel">monorepo</a> instead of in <code class="highlighter-rouge">packages/</code>. Then we should rename all proposals to <code class="highlighter-rouge">babel-plugin-proposal-</code> instead of <code class="highlighter-rouge">babel-plugin-transform-</code> Change our publish process (probably through Lerna) to publish the packages in <code class="highlighter-rouge">experimental/</code> independently.</p></blockquote><h2 id="-possible-deprecations">💀 Possible Deprecations</h2><h3 id="deprecate-the-env-option-in-babelrc">Deprecate the “env” option in <code class="highlighter-rouge">.babelrc</code></h3><blockquote><p><a href="https://github.com/babel/babel/issues/5276">babel/babel#5276</a></p></blockquote><p>The “env” configuration option (not to be confused with babel-preset-env) has been a source of confusion for our users as seen by the numerous issues reported.</p><p>The <a href="http://babeljs.io/docs/usage/babelrc/#env-option">current behavior</a> is to merge the config values into the top level values which isn’t always intuitive such that developers end up putting nothing in the top level and just duplicating all the presets/plugins under separate envs.</p><p>To eliminate the confusion (and help our power users), we’re considering dropping the env config option all together and recommending users use the proposed JS config format (see below).</p><h3 id="deprecate-es20xx-presets">Deprecate ES20xx presets</h3><blockquote><p>We already deprecated preset-latest a while ago, and ES2016/ES2017 <a href="https://twitter.com/left_pad/status/897483806499885057">earlier</a> It’s annoying making a yearly preset (extra package/dependency, issues with npm package squatting unless we do scoped packages)</p></blockquote><p>Developers shouldn’t even need to make the decision of what yearly preset to use? If we drop/deprecate these presets then everyone can use <a href="https://github.com/babel/babel-preset-env">babel-preset-env</a> instead which will already update as the spec changes.</p><h2 id="-questions">🤔 Questions</h2><h3 id="deprecaterenameremove-stage-x-presets"><del>Deprecate/Rename/Remove Stage X presets</del></h3><blockquote><p>We’ll probably keep these and just make major version bumps.</p></blockquote><p>Many in the community (and TC39) have expressed concerns over the Stage X presets. I believe I just added them to have an easy migration path from Babel 5 to Babel 6 (used to be a “stage” option).</p><p>While we want to have an easy to use tool, it turns out that many companies/developers use these “not yet JavaScript” presets all the time, and in production. “Stage 0” doesn’t really set the same tone as <code class="highlighter-rouge">babel-preset-dont-use-this-stage-0</code>.</p><blockquote><p>Ariya just made an <a href="https://twitter.com/AriyaHidayat/status/833797322786025472">awesome poll</a> that explains what I’m talking about</p></blockquote><p>Developers don’t actually know what features are in what version of JavaScript (and they shouldn’t have to know). However it is a problem when we all start thinking that “features” that are actually still proposals are in the spec already.</p><p>Many open source projects (including Babel still 😝), tutorials, conference talks, etc all use <code class="highlighter-rouge">stage-0</code>. React promotes the use of JSX, class properties (now Stage 3), object rest/spread (now Stage 3) and we all believe that it’s just JavaScript because Babel compiled it for them. So maybe removing this abstraction would help people understand more about what is going on and the tradeoffs one is making when choosing to use Stage X plugins.</p><p>It also seems much easier to maintain your own preset than to have to update the Stage preset.</p><blockquote><p>I often see people go “I want object rest, and that’s stage 2, so I enabled stage 2”. They now have a load of other experimental features enabled they might not know about and probably don’t need. Also, as stages change over time then people who aren’t using shrinkwrap or yarn will get new features appearing, possibly without their knowledge. If a feature is canned they might even get one vanishing. @glenjamin</p></blockquote><h3 id="using-npm-scoped-packages">Using npm Scoped Packages</h3><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Thoughts on <a href="https://twitter.com/babeljs">@babeljs</a> using npm scoped packages for 7.0?</p>&mdash; Henry Zhu (@left_pad) <a href="https://twitter.com/left_pad/status/821551189166878722">January 18, 2017</a></blockquote><script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script><p>Seems like most who understood what scoped packages are were in favor?</p><p>Pros</p><ul><li>Don’t have to worry about getting a certain package name (the reason why this was brought up in the first place).</li></ul><blockquote><p>Many package names have been taken (preset-es2016, preset-es2017, 2020, 2040, etc). Can always ask to transfer but not always easy to do and can lead to users believing certain packages are official due to the naming.</p></blockquote><p>Cons</p><ul><li>We need to migrate to new syntax</li><li>Still unsupported on certain non-npm tools (lock-in)</li><li>No download counts unless we alias back to old names</li></ul><p>Sounds like we may want to defer, and in the very least it’s not a breaking change given it’s a name change.</p><h3 id="external-helpers-transform-runtime-babel-polyfill"><code class="highlighter-rouge">external-helpers</code>, <code class="highlighter-rouge">transform-runtime</code>, <code class="highlighter-rouge">babel-polyfill</code></h3><blockquote><p>“regeneratorRuntime is not defined” - reported all the time.</p></blockquote><p>Basically we need a better solution around how to deal with built-ins/polyfills.</p><ul><li>Developers don’t know what regenerator-runtime is, they just want to use generators/async functions.</li><li>Many developers are confused as to why a runtime is needed at all or why Babel doesn’t compile <code class="highlighter-rouge">Promise</code>, <code class="highlighter-rouge">Object.assign</code>, or some other built-in.</li><li>Developers are confused with the difference between <code class="highlighter-rouge">transform-runtime</code> the Babel plugin and the runtime itself, <code class="highlighter-rouge">babel-runtime</code>.</li><li>Complaints about generated code size since <code class="highlighter-rouge">babel-polyfill</code> includes all polyfills (although now we have <a href="https://github.com/babel/babel-preset-env#usebuiltins"><code class="highlighter-rouge">useBuiltIns</code></a>) and no one knowing about <code class="highlighter-rouge">external-helpers</code></li></ul><p>Can we combine/replace these packages and have an easier, default experience?</p><h2 id="whats-next">What’s next?</h2><p>We want the community to upgrade and provide their feedback/reports. There will probably be a lot of initial activity which can be overwhelming so please be patient with us. We’d appreciate the help in helping triage, write docs/upgrade guides/tips, and codemods to help others upgrade more seamlessly. Because Babel touches a lot of the JavaScript ecosystem, it may not be as simple as simply updating one package because it could depend on other community Babel plugins on npm. We’re not going to just wait around for a month and hope people upgrade, there’s a lot of work to be done to make this happen without half the community still staying on 6.x next year. I’d not like to leave projects (and people) behind. So let us know what we can do to help, and I’d ask that you’d do the same for us and the rest of the community.</p><h2 id="project-sustainibility">Project Sustainibility</h2><p>Shoutout to my team at <a href="https://www.behance.net">Behance</a> for allowing me to work on Babel part-time at work; we’re still basically the only company working to sustain Babel in any capacity on work time. I’m really glad to be able to support the project at work instead of only after work/weekends, and hope this can be the case for more maintainers in the future. (I hope we’ve been a good example of how companies can support the open source projects they use and not necessarily “own”).</p><p>We don’t have enough in our Open Collective still to pay someone full time: I believe the highest donation we’ve gotten is $750 from Webflow, and highest monthly donation is $100 from various individuals/companies, so either we some work there or we work on getting more companies involved like AMP/Google have done (@jridgewell who recently joined our team is able to spend work time as well, and it’s made a big difference).</p><p>Ask if your company can sponsor with our <a href="https://opencollective.com/babel">Open Collective</a>, let us know what’s missing, how you can get involved. You don’t even have to have a specific reason to get involved. If you simply care about sustaining a project for the forseable future, just get your team plugged in and get involved.</p><h2 id="future">Future</h2><p>After 7.0: there’s a lot of potential avenues for us to explore (that we’ve all brought up years ago): separating traversal from plugins (async visitors?), immutable AST, syntax extensions? On the infra side: integrating with test262 and smoke tests, better github workflow to go from proposal to transform, codemod infrastructure for automatic upgrades, etc.</p><p>Follow our meeting notes/discussions on <a href="https://github.com/babel/notes">babel/notes</a> and get involved!</p><h2 id="thanks">Thanks!</h2><p>I’m hopeful that we can do the official release soon, but I’d like to mention that open source is sustained by consistent, day-to-day maintenance and not just a hyped-up release cycle where we just leave everyone else in the dust and move on so it may take a little longer as we wait to fixup bugs and upgrade the ecoystem.</p></div></div></div><div class="footer text-center"><p><a href="https://github.com/docschina/babeljs.io">Babel中文网</a> · <a href="https://github.com/docschina/babeljs.io/blob/cn/LICENSE">遵循 CC-BY-4.0 许可协议</a> · <a href="https://github.com/babel/babel/blob/master/CODE_OF_CONDUCT.md">代码规范</a></p><p><a href="http://henryzoo.com/babel.github.io/">查看 Babel 5.x 文档?</a> · 发现文档中的问题，提交到 <a href="https://github.com/docschina/babeljs.io/issues/new">这里</a>.</p><p>特别鸣谢 <a href="https://cloud.tencent.com/">腾讯云</a> · <a href="http://www.bootcss.com/">Bootstrap中文网</a> 提供服务和支持</p><br/><p><a href=" " target="_blank">冀ICP备14002930号</a></p></div><script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js' defer></script> <script src='https://cdn.bootcss.com/lodash.js/4.16.3/lodash.min.js' defer></script> <script src='https://cdn.bootcss.com/bootstrap/3.3.1/js/bootstrap.min.js' defer></script> <script src='https://cdn.bootcss.com/clipboard.js/1.5.13/clipboard.min.js' defer></script> <script src='https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js' defer></script> <script src='/scripts/search.js?v=1' defer></script> <script src='/scripts/clipboard.js' defer></script> <script src='/scripts/open-in-repl.js' defer></script> <script> document.addEventListener('DOMContentLoaded', function() { $("html").removeClass("no-js").addClass("js"); }); </script></body></html>
