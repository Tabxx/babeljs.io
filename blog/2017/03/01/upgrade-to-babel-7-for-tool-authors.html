<!DOCTYPE html><html lang="zh-CN" class="no-js"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Upgrade to Babel 7 for Tool Authors (WIP) | Babel中文网</title><meta name="description" content="EDIT: please refer to the new upgrade page"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /><link rel="stylesheet" href="/css/main.css?t=2018-09-20T02:07:13+00:00"><link rel="canonical" href="https://babeljs.cn/blog/2017/03/01/upgrade-to-babel-7-for-tool-authors.html"><link rel="alternate" type="application/rss+xml" title="Babel" href="https://babeljs.cn/feed.xml" /><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="og:url" content="https://babeljs.cn"><meta name="og:image" content="website"><meta name="og:title" content="Upgrade to Babel 7 for Tool Authors (WIP) | Babel中文网"><meta name="og:description" content="EDIT: please refer to the new upgrade page"><meta name="og:image" content="https://babeljs.cn/images/share-image.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@babeljs"><meta name="twitter:title" content="Upgrade to Babel 7 for Tool Authors (WIP) | Babel中文网"><meta name="twitter:description" content="EDIT: please refer to the new upgrade page"><meta name="twitter:image:src" content="https://babeljs.cn/images/share-image.png"><meta name="twitter:url" content="https://babeljs.cn/blog/2017/03/01/upgrade-to-babel-7-for-tool-authors.html"> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?7d7e96af885ecd66a8c4ac73dc983681"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script></head><input type="checkbox" id="babel-toggle-search" class="babel-toggle-search-checkbox" /><header class="navbar navbar-default navbar-fixed-top babel-nav" id="top" role="banner"><div class="container"> <a href="/" class="navbar-brand logo">Babel</a><div class="babel-navbar-toggles"><div class="navbar-header"> <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#babel-navbar" aria-controls="babel-navbar" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label></div></div><nav id="babel-navbar" class="collapse navbar-collapse babel-navbar"><ul class="nav navbar-nav"><li > <a href="/learn-es2015/">学习 ES2015</a></li><li class="dropdown "> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">文档 <span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li > <a href="/docs/setup/">配置</a></li><li > <a href="/docs/editors.html">编辑器</a></li><li > <a href="/docs/usage/caveats/">注意事项</a></li><li > <a href="/docs/community/videos/">视频</a></li><li class="group-name">相关依赖</li><li > <a href="/docs/core-packages/">babel-core</a></li><li > <a href="/docs/usage/polyfill/">babel-polyfill</a></li><li > <a href="/docs/plugins/">Plugins</a></li><li class="group-name">使用方式</li><li > <a href="/docs/usage/babelrc/">.babelrc</a></li><li > <a href="/docs/usage/cli/">babel-cli</a></li><li > <a href="/docs/usage/babel-register/">babel-register</a></li><li > <a href="/docs/usage/api/">API</a></li></ul></li><li > <a href="/repl/">试用</a></li><li class="active"> <a href="/blog/">Blog</a></li><li > <a href="/faq">常见问题</a></li><li > <a href="/team">团队</a></li><li > <a href="https://docschina.org/">印记中文</a></li><li > <a href="https://babel.docschina.org/">Babel V7</a></li></ul><ul class="nav navbar-nav navbar-right nav-social"><li> <a href="https://opencollective.com/babel">赞助</a></li><li> <a href="https://slack.babeljs.io/" title="Join us on Slack"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect x="219.27" y="221.3" width="72.04" height="69.58" transform="translate(-67.42 94.64) rotate(-18.52)"/><path d="M489.84,185.3C437,9.29,360.9-31.64,184.9,21.16S-32,150.1,20.76,326.1,149.7,543,325.7,490.24,542.64,361.3,489.84,185.3ZM401,299.5l-33.15,11.05,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18l-11.46-34.38-68.36,22.92,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18L198.81,367l-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18c-4.5-13.92,2.87-29.06,16.78-33.56L182,316.69l-22.1-65.9-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18C88.71,231.14,96.08,216,110,211.49l33.15-11.05-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78l11.46,34.38,68.36-22.92-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78L312.2,144l33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78s-2.87,29.06-16.78,33.56L329,194.3l22.1,65.9,33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78S414.93,295,401,299.5Z" transform="translate(0.7 0.3)"/></svg> </a></li><li> <a href="https://twitter.com/babeljs" title="Follow us on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 416.32"><title>twitter</title><path d="M160.83,464.16c193.2,0,298.92-160.22,298.92-298.92,0-4.51,0-9-.2-13.52A214,214,0,0,0,512,97.22a212.93,212.93,0,0,1-60.44,16.6,105.7,105.7,0,0,0,46.3-58.19A209,209,0,0,1,431.07,81a105.09,105.09,0,0,0-181.73,71.91,116.12,116.12,0,0,0,2.66,24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48,105.48,0,0,0,68,207.44a106.27,106.27,0,0,1-47.53-13.11v1.43a105.28,105.28,0,0,0,84.21,103.06,105.67,105.67,0,0,1-47.33,1.84,105.06,105.06,0,0,0,98.14,72.94A210.72,210.72,0,0,1,25,418.68a202.17,202.17,0,0,1-25-1.43,298.85,298.85,0,0,0,160.83,46.92" transform="translate(0 -47.84)" fill="#010101"/></svg> </a></li><li> <a href="https://github.com/babel/babel" title="Contribute on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36"><path d="M256,6.32c-141.36,0-256,114.61-256,256,0,113.09,73.34,209,175.08,242.9,12.8,2.35,17.47-5.56,17.47-12.34,0-6.08-.22-22.18-.35-43.54C121,464.83,106,415,106,415c-11.64-29.57-28.42-37.45-28.42-37.45C54.31,361.71,79.31,362,79.31,362c25.69,1.81,39.21,26.38,39.21,26.38,22.84,39.12,59.92,27.82,74.5,21.27,2.33-16.54,8.94-27.82,16.25-34.22C152.43,369,92.67,347,92.67,248.94c0-27.95,10-50.8,26.35-68.69-2.63-6.48-11.42-32.5,2.51-67.75,0,0,21.49-6.88,70.4,26.24a242.65,242.65,0,0,1,128.18,0c48.87-33.13,70.33-26.24,70.33-26.24,14,35.25,5.18,61.27,2.55,67.75,16.41,17.9,26.31,40.75,26.31,68.69,0,98.35-59.85,120-116.88,126.32,9.19,7.9,17.38,23.53,17.38,47.41,0,34.22-.31,61.83-.31,70.23,0,6.85,4.61,14.81,17.6,12.31C438.72,471.29,512,375.4,512,262.34,512,120.94,397.37,6.32,256,6.32Z" transform="translate(0 -6.32)" fill="#191717" fill-rule="evenodd"/></svg> </a></li></ul><label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">打开搜索</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label><div class="navbar-form navbar-right babel-search" role="search"><div class="input-group"> <label class="sr-only" aria-label="Search" for="babel-search-input">搜索</label><div class="babel-search-input-wrapper"> <input type="text" class="form-control" id="babel-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="在文档中搜索..."> <label for="babel-toggle-search" class="babel-toggle-search-close"> <span class="sr-only">关闭搜索</span> <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span> </label></div></div></div></nav></div></header><div class="docs-header"><div class="container"><div class="row"><div class="col-md-6 col-md-push-3 text-center"><h1>Upgrade to Babel 7 for Tool Authors (WIP)</h1></div></div></div></div><div class="container"><div class="row"><div class="col-md-8 col-md-push-2 babel-blog-content"><p class="small text-center text-muted">Posted Mar 1, 2017 by Sven SAULEAU, Henry Zhu</p><p><a href="http://new.babeljs.io/docs/en/next/v7-migration-api.html">EDIT: please refer to the new upgrade page</a></p><p>Refer users to this document for those that create tools that depend on Babel (such as Babel plugins).</p><blockquote><p>Also check out the <a href="/blog/2017/03/01/upgrade-to-babel-7.html">User Upgrade Guide</a> for other relevant changes.</p></blockquote><h2 id="all-babel-packages">All Babel packages</h2><h3 id="nodejs-support">NodeJS support</h3><p><img src="https://img.shields.io/badge/level%20of%20awesomeness%3F-high-red.svg" alt="high" /></p><p>Support for Node.js 0.10 and 0.12 has been dropped as both of this versions are out of maintenance.</p><h3 id="export-changes">Export changes</h3><p><img src="https://img.shields.io/badge/risk%20of%20breakage%3F-medium-yellow.svg" alt="medium" /></p><p>Dropped use of <code class="highlighter-rouge">add-module-exports</code> plugin on Babel packages. This had to be used earlier to prevent a breaking change with our exports. If you import a Babel package in a library you may need to use <code class="highlighter-rouge">.default</code> when using <code class="highlighter-rouge">require</code> rather than <code class="highlighter-rouge">import</code>.</p><h2 id="babel-core"><code class="highlighter-rouge">babel-core</code></h2><p>The publicly exposed but undocumented <code class="highlighter-rouge">Pipeline</code> class has been removed. Best to use the transformation methods exposed from <code class="highlighter-rouge">babel-core</code> directly <a href="https://github.com/babel/babel/pull/5376">babel/babel#5376</a>.</p><p>The <code class="highlighter-rouge">babel.util.*</code> helper methods have been removed, and <code class="highlighter-rouge">util.EXTENSIONS</code> has been moved to <code class="highlighter-rouge">babel.DEFAULT_EXTENSIONS</code> <a href="https://github.com/babel/babel/pull/5487">babel/babel#5487</a>.</p><p>Calls to <code class="highlighter-rouge">babel.transform</code> or any other transform function may return <code class="highlighter-rouge">null</code> if the file matched an <code class="highlighter-rouge">ignore</code> pattern or failed to match an <code class="highlighter-rouge">only</code> pattern <a href="https://github.com/babel/babel/pull/5487">babel/babel#5487</a>.</p><p>The <code class="highlighter-rouge">opts.basename</code> option exposed on <code class="highlighter-rouge">state.file.opts</code> has been removed. If you need it, best to build it from <code class="highlighter-rouge">opts.filename</code> yourself <a href="https://github.com/babel/babel/pull/5467">babel/babel#5467</a>.</p><h2 id="babylon">Babylon</h2><blockquote><p>Removed the <code class="highlighter-rouge">*</code> plugin option <a href="https://github.com/babel/babylon/pull/301">#301</a> <img src="https://img.shields.io/badge/risk%20of%20breakage%3F-low-yellowgreen.svg" alt="low" /></p></blockquote><p>This was first added in v6.14.1 (Nov 17, 2016) so it’s unlikely anyone was using this.</p><p>This catch-all option was removed; instead you should specifically decide which plugins you want to activate.</p><p>We thought it would be a good idea for tools so they wouldn’t have to constantly update their config but it also means we can’t easily make a breaking change.</p><p>Before:</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">babylon</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span> <span class="s2">"*"</span> <span class="p">]</span>
<span class="p">})</span>
</code></pre></div><p>You can get the old behavior using:</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">babylon</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">code</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">"asyncGenerators"</span><span class="p">,</span>
    <span class="s2">"classProperties"</span><span class="p">,</span>
    <span class="s2">"decorators"</span><span class="p">,</span>
    <span class="s2">"doExpressions"</span><span class="p">,</span>
    <span class="s2">"dynamicImport"</span><span class="p">,</span>
    <span class="s2">"exportExtensions"</span><span class="p">,</span>
    <span class="s2">"flow"</span><span class="p">,</span>
    <span class="s2">"functionBind"</span><span class="p">,</span>
    <span class="s2">"functionSent"</span><span class="p">,</span>
    <span class="s2">"jsx"</span><span class="p">,</span>
    <span class="s2">"objectRestSpread"</span><span class="p">,</span>
  <span class="p">]</span>
<span class="p">})</span>
</code></pre></div><p>See Babylon’s <a href="https://babeljs.io/docs/core-packages/babylon/#api-plugins">plugin options</a>.</p><blockquote><p>Removed <code class="highlighter-rouge">classConstructorCall</code> plugin <a href="https://github.com/babel/babylon/pull/291">#291</a> <img src="https://img.shields.io/badge/risk%20of%20breakage%3F-low-yellowgreen.svg" alt="low" /></p></blockquote><h2 id="babel-traverse"><code class="highlighter-rouge">babel-traverse</code></h2><blockquote><p><code class="highlighter-rouge">getFunctionParent</code> will no longer return <code class="highlighter-rouge">Program</code>, please use <code class="highlighter-rouge">getProgramParent</code> instead <a href="https://github.com/babel/babel/pull/5923">#5923</a>. <img src="https://img.shields.io/badge/risk%20of%20breakage%3F-low-yellowgreen.svg" alt="low" /></p></blockquote><p>It doesn’t make sense that a function named <code class="highlighter-rouge">getFunctionParent</code> also returns the Program, so that was removed.</p><p>To get the equivalent behavior, you’ll need to make a change like</p><div class="language-diff highlighter-rouge"><pre class="highlight"><code><span class="gd">- path.scope.getFunctionParent()
</span><span class="gi">+ path.scope.getFunctionParent() || path.scope.getProgramParent()
</span></code></pre></div><blockquote><p>Path replacement/removal APIs now return an array of new paths <img src="https://img.shields.io/badge/risk%20of%20breakage%3F-low-yellowgreen.svg" alt="low" /></p></blockquote><p>For instance, using <code class="highlighter-rouge">Path#insertBefore</code>, or <code class="highlighter-rouge">Path#replaceWith</code> will now always return an array of the newly inserted/replaced paths.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">node</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">nullLiteral</span><span class="p">();</span>
<span class="kr">const</span> <span class="p">[</span><span class="nx">replaced</span><span class="p">]</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span>
<span class="nx">replace</span><span class="p">.</span><span class="nx">node</span> <span class="o">===</span> <span class="nx">node</span><span class="p">;</span> <span class="c1">// =&gt; true</span>
</code></pre></div><p>This is especially useful when inserting serveral nodes into some higher-up scope, since you can immediately call the <code class="highlighter-rouge">Path</code> APIs on the node’s new <code class="highlighter-rouge">Path</code>.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">const</span> <span class="nx">parent</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">findParent</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="cm">/* some selection criteria */</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">helperPaths</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">unshiftContainer</span><span class="p">(</span><span class="s2">"body"</span><span class="p">,</span> <span class="nx">helpers</span><span class="p">);</span>
<span class="c1">// helperPaths can now be referenced, manipulated, etc.</span>
</code></pre></div><h2 id="ast-changes">AST changes</h2><h3 id="jsx-and-ts-node-builders-from-babeltypes-package-renamed">JSX* and TS* node builders (from @babel/types package) renamed</h3><p>The case has been changed: <code class="highlighter-rouge">jsx</code> and <code class="highlighter-rouge">ts</code> are now in lowercase.</p><div class="language-diff highlighter-rouge"><pre class="highlight"><code><span class="gd">- t.jSXIdentifier()
</span><span class="gi">+ t.jsxIdentifier()
</span></code></pre></div><h3 id="expression-field-removed-from-arrowfunctionexpression"><code class="highlighter-rouge">.expression</code> field removed from <code class="highlighter-rouge">ArrowFunctionExpression</code></h3><p>The <code class="highlighter-rouge">expression</code> field was removed to eliminate two different sources of truth and needing plugins to manually keep them in sync. You can now simply check whether the function body is a <code class="highlighter-rouge">BlockStatement</code> or not:</p><div class="language-diff highlighter-rouge"><pre class="highlight"><code>  return {
    visitor: {
      ArrowFunctionExpression({ node }) {
<span class="gd">-       if (node.expression) {
</span><span class="gi">+       if (node.body.type !== "BlockStatement") {
</span>          // () =&gt; foo;
        }
      }
    }
  };
</code></pre></div><h3 id="tokens-removed">Tokens removed</h3><p>In previous versions <code class="highlighter-rouge">tokens</code> were always attached to the AST on the top-level. In the latests version of babylon we removed this behavior and made it disabled by default to improve the performance of the parser. All usages in babel itself have been remove and <code class="highlighter-rouge">babel-generator</code> is not using the tokens anymore for pretty printing.</p><p>If your babel-plugin uses <code class="highlighter-rouge">tokens</code> at the moment, evaluate if it is still necessary and try to remove the usage if possible. If your plugin really depends on getting tokens you can reactivate it but please only consider this if there is no other way as this will hurt users performance.</p><p>To activate you need to set the <code class="highlighter-rouge">tokens</code> option of babylon to true. You can do this directly from your plugin.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="nx">manipulateOptions</span><span class="p">(</span><span class="nx">opts</span><span class="p">,</span> <span class="nx">parserOpts</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">parserOpts</span><span class="p">.</span><span class="nx">tokens</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="p">...</span>
  <span class="p">};</span>
<span class="p">}</span>
</code></pre></div><h3 id="renamed">Renamed</h3><p>The following nodes have been renamed:</p><table><thead><tr><th>Name 6.x</th><th>Name 7.x</th><th>Example</th><th>PR</th></tr></thead><tbody><tr><td>ExistentialTypeParam</td><td>ExistsTypeAnnotation</td><td><code class="highlighter-rouge">type A = B&lt;*&gt;;</code></td><td><a href="https://github.com/babel/babylon/pull/322">#322</a></td></tr><tr><td>NumericLiteralTypeAnnotation</td><td>NumberLiteralTypeAnnotation</td><td><code class="highlighter-rouge">type T = 0;</code></td><td><a href="https://github.com/babel/babylon/pull/332">#332</a></td></tr></tbody></table><p>Besides the AST-Nodes also all the functions in <code class="highlighter-rouge">babel-type</code> have been renamed.</p><div class="language-diff highlighter-rouge"><pre class="highlight"><code> import * as t from "babel-types";

 return {
<span class="gd">-  ExistentialTypeParam(path) {
-    const parent = path.findParent((path) =&gt; path.isExistentialTypeParam());
-    t.isExistentialTypeParam(parent);
</span><span class="gi">+  ExistsTypeAnnotation(path) {
+    const parent = path.findParent((path) =&gt; path.isExistsTypeAnnotation());
+    t.isExistsTypeAnnotation(parent);
</span>
<span class="gd">-    return t.existentialTypeParam();
</span><span class="gi">+    return t.existsTypeAnnotation();
</span>   },
<span class="gd">-  NumericLiteralTypeAnnotation(path) {
-    const parent = path.findParent((path) =&gt; path.isNumericLiteralTypeAnnotation());
-    t.isNumericLiteralTypeAnnotation(parent);
</span><span class="gi">+  NumberLiteralTypeAnnotation(path) {
+    const parent = path.findParent((path) =&gt; path.isNumberLiteralTypeAnnotation());
+    t.isNumberLiteralTypeAnnotation(parent);
</span>
<span class="gd">-    return t.numericLiteralTypeAnnotation();
</span><span class="gi">+    return t.numberLiteralTypeAnnotation();
</span>   }
 };
</code></pre></div><h3 id="replaced">Replaced</h3><p>On the following AST-Nodes the value of the field <code class="highlighter-rouge">variance</code> has been changed from a simple string value to be its own AST-Node called <code class="highlighter-rouge">Variance</code>. <a href="https://github.com/babel/babylon/pull/333">#333</a></p><p>The field is only available when enabling the <code class="highlighter-rouge">flow</code> plugin in babylon.</p><ul><li>ObjectProperty</li><li>ObjectMethod</li><li>AssignmentProperty</li><li>ClassMethod</li><li>ClassProperty</li><li>Property</li></ul><p>The type of the new <code class="highlighter-rouge">Variance</code> node looks like this:</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">type</span> <span class="nx">VarianceNode</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">type</span><span class="p">:</span> <span class="s2">"Variance"</span><span class="p">,</span>
  <span class="na">kind</span><span class="p">:</span> <span class="s2">"plus"</span><span class="o">|</span><span class="s2">"minus"</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div><div class="language-diff highlighter-rouge"><pre class="highlight"><code> return {
   Property({ node }) {
<span class="gd">-    if (node.variance === "plus") {
</span><span class="gi">+    if (node.variance.kind === "plus") {
</span>       ...
<span class="gd">-    } else if (node.variance === "minus") {
</span><span class="gi">+    } else if (node.variance.kind === "minus") {
</span>       ...
     }
   }
 };
</code></pre></div><h3 id="location-changes">Location changes</h3><p>The location info of <code class="highlighter-rouge">ObjectTypeIndexer</code> has been changed to not include semicolons. This was done to align with the flow-parser and have the same location information. <a href="https://github.com/babel/babylon/pull/228">#228</a></p><p>Example:</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">a</span><span class="err">:</span> <span class="p">{</span> <span class="p">[</span><span class="nx">a</span><span class="err">:</span> <span class="nx">number</span><span class="p">]</span><span class="err">:</span> <span class="nx">string</span><span class="p">;</span> <span class="p">};</span>
</code></pre></div><div class="language-diff highlighter-rouge"><pre class="highlight"><code> {
   "type": "ObjectTypeIndexer",
   "start": 9,
<span class="gd">-  "end": 29,
</span><span class="gi">+  "end": 28,
</span>   "loc": {
     "start": {
       "line": 1,
       "column": 9,
     },
     "end": {
       "line": 1,
<span class="gd">-      "column": 29
</span><span class="gi">+      "column": 28
</span>     }
   }
 }
</code></pre></div><h3 id="removal">Removal</h3><h4 id="forawaitstatement">ForAwaitStatement</h4><p>The AST-Node <code class="highlighter-rouge">ForAwaitStatement</code> has been removed and is replace with the field <code class="highlighter-rouge">await</code> in the <code class="highlighter-rouge">ForOfStatement</code> node <a href="https://github.com/babel/babylon/pull/349">#349</a></p><div class="language-diff highlighter-rouge"><pre class="highlight"><code> interface ForOfStatement &lt;: ForInStatement {
   type: "ForOfStatement";
<span class="gi">+  await: boolean;
</span> }
</code></pre></div><div class="language-diff highlighter-rouge"><pre class="highlight"><code> return {
<span class="gd">-  ForAwaitStatement(path) {
-    ...
</span><span class="gi">+  ForOfStatement(path) {
+    if (path.node.await) {
+      ...
+    }
</span>   }
 };
</code></pre></div><h4 id="restproperty--spreadproperty">RestProperty &amp; SpreadProperty</h4><p>The two AST-Nodes <code class="highlighter-rouge">RestProperty</code> and <code class="highlighter-rouge">SpreadProperty</code> have been removed in favor of reusing <code class="highlighter-rouge">RestElement</code> and <code class="highlighter-rouge">SpreadElement</code> <a href="https://github.com/babel/babylon/pull/384">#384</a></p><div class="language-diff highlighter-rouge"><pre class="highlight"><code> return {
   SpreadElement(path) {
<span class="gd">-    ...
-  },
-  SpreadProperty(path) {
-    ...
</span><span class="gi">+    if (path.parentPath.isObjectExpression()) {
+      ...
+    } else if (path.parentPath.isArrayExpression()) {
+      ...
+    }
</span>   },
   RestElement(path) {
<span class="gd">-    ...
-  },
-  RestProperty(path) {
-    ...
</span><span class="gi">+    if (path.parentPath.isObjectPattern()) {
+      ...
+    } else if (path.parentPath.isArrayPattern()) {
+      ...
+    }
</span>   }
 };
</code></pre></div><p>See our <a href="https://github.com/babel/babel/pull/5317">upgrade PR for Babel</a> and the <a href="https://github.com/babel/babylon/blob/7.0/ast/spec.md">Babylon AST spec</a> for more information.</p></div></div></div><div class="footer text-center"><p><a href="https://github.com/docschina/babeljs.io">Babel中文网</a> · <a href="https://github.com/docschina/babeljs.io/blob/cn/LICENSE">遵循 CC-BY-4.0 许可协议</a> · <a href="https://github.com/babel/babel/blob/master/CODE_OF_CONDUCT.md">代码规范</a></p><p><a href="http://henryzoo.com/babel.github.io/">查看 Babel 5.x 文档?</a> · 发现文档中的问题，提交到 <a href="https://github.com/docschina/babeljs.io/issues/new">这里</a>.</p><p>特别鸣谢 <a href="https://cloud.tencent.com/">腾讯云</a> · <a href="http://www.bootcss.com/">Bootstrap中文网</a> 提供服务和支持</p><br/><p><a href=" " target="_blank">冀ICP备14002930号</a></p></div><script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js' defer></script> <script src='https://cdn.bootcss.com/lodash.js/4.16.3/lodash.min.js' defer></script> <script src='https://cdn.bootcss.com/bootstrap/3.3.1/js/bootstrap.min.js' defer></script> <script src='https://cdn.bootcss.com/clipboard.js/1.5.13/clipboard.min.js' defer></script> <script src='https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js' defer></script> <script src='/scripts/search.js?v=1' defer></script> <script src='/scripts/clipboard.js' defer></script> <script src='/scripts/open-in-repl.js' defer></script> <script> document.addEventListener('DOMContentLoaded', function() { $("html").removeClass("no-js").addClass("js"); }); </script> <script src='https://platform.twitter.com/widgets.js' defer></script> <script src="/scripts/docs.js?t=2018-09-20T02:07:13+00:00" defer></script></body></html>
