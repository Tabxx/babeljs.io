<!DOCTYPE html><html lang="zh-CN" class="no-js"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Nearing the 7.0 Release | Babel中文网</title><meta name="description" content=" Check out Planning for 7.0 for the last updates throughout the 7.0 pre-releases. If something isn’t clear in this post let me know!"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" /><link rel="stylesheet" href="/css/main.css?t=2018-09-18T02:18:06+00:00"><link rel="canonical" href="https://babeljs.cn/blog/2017/12/27/nearing-the-7.0-release.html"><link rel="alternate" type="application/rss+xml" title="Babel" href="https://babeljs.cn/feed.xml" /><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="og:url" content="https://babeljs.cn"><meta name="og:image" content="website"><meta name="og:title" content="Nearing the 7.0 Release | Babel中文网"><meta name="og:description" content=" Check out Planning for 7.0 for the last updates throughout the 7.0 pre-releases. If something isn’t clear in this post let me know!"><meta name="og:image" content="https://babeljs.cn/images/share-image.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@babeljs"><meta name="twitter:title" content="Nearing the 7.0 Release | Babel中文网"><meta name="twitter:description" content=" Check out Planning for 7.0 for the last updates throughout the 7.0 pre-releases. If something isn’t clear in this post let me know!"><meta name="twitter:image:src" content="https://babeljs.cn/images/share-image.png"><meta name="twitter:url" content="https://babeljs.cn/blog/2017/12/27/nearing-the-7.0-release.html"> <script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?7d7e96af885ecd66a8c4ac73dc983681"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script></head><input type="checkbox" id="babel-toggle-search" class="babel-toggle-search-checkbox" /><header class="navbar navbar-default navbar-fixed-top babel-nav" id="top" role="banner"><div class="container"> <a href="/" class="navbar-brand logo">Babel</a><div class="babel-navbar-toggles"><div class="navbar-header"> <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#babel-navbar" aria-controls="babel-navbar" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label></div></div><nav id="babel-navbar" class="collapse navbar-collapse babel-navbar"><ul class="nav navbar-nav"><li > <a href="/learn-es2015/">学习 ES2015</a></li><li class="dropdown "> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">文档 <span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li > <a href="/docs/setup/">配置</a></li><li > <a href="/docs/editors.html">编辑器</a></li><li > <a href="/docs/usage/caveats/">注意事项</a></li><li > <a href="/docs/community/videos/">视频</a></li><li class="group-name">相关依赖</li><li > <a href="/docs/core-packages/">babel-core</a></li><li > <a href="/docs/usage/polyfill/">babel-polyfill</a></li><li > <a href="/docs/plugins/">Plugins</a></li><li class="group-name">使用方式</li><li > <a href="/docs/usage/babelrc/">.babelrc</a></li><li > <a href="/docs/usage/cli/">babel-cli</a></li><li > <a href="/docs/usage/babel-register/">babel-register</a></li><li > <a href="/docs/usage/api/">API</a></li></ul></li><li > <a href="/repl/">试用</a></li><li class="active"> <a href="/blog/">Blog</a></li><li > <a href="/faq">常见问题</a></li><li > <a href="/team">团队</a></li><li > <a href="https://docschina.org/">印记中文</a></li><li > <a href="https://babel.docschina.org/">Babel V7</a></li></ul><ul class="nav navbar-nav navbar-right nav-social"><li> <a href="https://opencollective.com/babel">赞助</a></li><li> <a href="https://slack.babeljs.io/" title="Join us on Slack"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect x="219.27" y="221.3" width="72.04" height="69.58" transform="translate(-67.42 94.64) rotate(-18.52)"/><path d="M489.84,185.3C437,9.29,360.9-31.64,184.9,21.16S-32,150.1,20.76,326.1,149.7,543,325.7,490.24,542.64,361.3,489.84,185.3ZM401,299.5l-33.15,11.05,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18l-11.46-34.38-68.36,22.92,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18L198.81,367l-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18c-4.5-13.92,2.87-29.06,16.78-33.56L182,316.69l-22.1-65.9-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18C88.71,231.14,96.08,216,110,211.49l33.15-11.05-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78l11.46,34.38,68.36-22.92-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78L312.2,144l33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78s-2.87,29.06-16.78,33.56L329,194.3l22.1,65.9,33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78S414.93,295,401,299.5Z" transform="translate(0.7 0.3)"/></svg> </a></li><li> <a href="https://twitter.com/babeljs" title="Follow us on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 416.32"><title>twitter</title><path d="M160.83,464.16c193.2,0,298.92-160.22,298.92-298.92,0-4.51,0-9-.2-13.52A214,214,0,0,0,512,97.22a212.93,212.93,0,0,1-60.44,16.6,105.7,105.7,0,0,0,46.3-58.19A209,209,0,0,1,431.07,81a105.09,105.09,0,0,0-181.73,71.91,116.12,116.12,0,0,0,2.66,24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48,105.48,0,0,0,68,207.44a106.27,106.27,0,0,1-47.53-13.11v1.43a105.28,105.28,0,0,0,84.21,103.06,105.67,105.67,0,0,1-47.33,1.84,105.06,105.06,0,0,0,98.14,72.94A210.72,210.72,0,0,1,25,418.68a202.17,202.17,0,0,1-25-1.43,298.85,298.85,0,0,0,160.83,46.92" transform="translate(0 -47.84)" fill="#010101"/></svg> </a></li><li> <a href="https://github.com/babel/babel" title="Contribute on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36"><path d="M256,6.32c-141.36,0-256,114.61-256,256,0,113.09,73.34,209,175.08,242.9,12.8,2.35,17.47-5.56,17.47-12.34,0-6.08-.22-22.18-.35-43.54C121,464.83,106,415,106,415c-11.64-29.57-28.42-37.45-28.42-37.45C54.31,361.71,79.31,362,79.31,362c25.69,1.81,39.21,26.38,39.21,26.38,22.84,39.12,59.92,27.82,74.5,21.27,2.33-16.54,8.94-27.82,16.25-34.22C152.43,369,92.67,347,92.67,248.94c0-27.95,10-50.8,26.35-68.69-2.63-6.48-11.42-32.5,2.51-67.75,0,0,21.49-6.88,70.4,26.24a242.65,242.65,0,0,1,128.18,0c48.87-33.13,70.33-26.24,70.33-26.24,14,35.25,5.18,61.27,2.55,67.75,16.41,17.9,26.31,40.75,26.31,68.69,0,98.35-59.85,120-116.88,126.32,9.19,7.9,17.38,23.53,17.38,47.41,0,34.22-.31,61.83-.31,70.23,0,6.85,4.61,14.81,17.6,12.31C438.72,471.29,512,375.4,512,262.34,512,120.94,397.37,6.32,256,6.32Z" transform="translate(0 -6.32)" fill="#191717" fill-rule="evenodd"/></svg> </a></li></ul><label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">打开搜索</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label><div class="navbar-form navbar-right babel-search" role="search"><div class="input-group"> <label class="sr-only" aria-label="Search" for="babel-search-input">搜索</label><div class="babel-search-input-wrapper"> <input type="text" class="form-control" id="babel-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="在文档中搜索..."> <label for="babel-toggle-search" class="babel-toggle-search-close"> <span class="sr-only">关闭搜索</span> <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span> </label></div></div></div></nav></div></header><div class="docs-header"><div class="container"><div class="row"><div class="col-md-6 col-md-push-3 text-center"><h1>Nearing the 7.0 Release</h1></div></div></div></div><div class="container"><div class="row"><div class="col-md-8 col-md-push-2 babel-blog-content"><p class="small text-center text-muted">Posted Dec 27, 2017 by <a href="https://twitter.com/left_pad">Henry Zhu</a></p><blockquote><p>Check out <a href="https://babeljs.io/blog/2017/09/12/planning-for-7.0">Planning for 7.0</a> for the last updates throughout the 7.0 pre-releases. If something isn’t clear in this post let me know!</p></blockquote><h2 id="project-updates">Project Updates</h2><ul><li>We started a new <a href="https://babeljs.io/docs/community/videos/">videos page</a>! We created this for people wanting to learn more about how Babel works and to help others contribute back. This page contains videos of conference talks on Babel and related concepts from team members and people in the community (you can send a PR if you have done a talk like this as well).</li></ul><p><a href="https://babeljs.io/docs/community/videos/"><img src="https://i.imgur.com/DkBEsfo.png" alt="videos" /></a></p><ul><li>We created a new <a href="https://babeljs.io/team">team page</a> as well! We will be updating this page in the future with more information about what people work on and why they are involved. For such a large project, there are many ways to get involved and help out.</li></ul><p><a href="https://babeljs.io/team"><img src="https://i.imgur.com/YcWgRwf.png" alt="team" /></a></p><ul><li>Babel turned 3 years old on <a href="https://babeljs.io/blog/2017/10/05/babel-turns-three">September 28, 2017</a>!</li><li>Daniel <a href="https://twitter.com/left_pad/status/926096965565370369">moved</a> <code class="highlighter-rouge">babel/babylon</code> and <code class="highlighter-rouge">babel/babel-preset-env</code> into the main Babel monorepo, <a href="https://github.com/babel/babel">babel/babel</a>, and this includes all git history, labels, issues.</li><li>We received a <a href="https://twitter.com/left_pad/status/923696620935421953">$1k/month donation</a> from Facebook Open Source!<ul><li>This the highest monthly donation we have gotten since the start (next highest is $100/month).</li><li>In the meantime, we will use our funds to meet in person and to send people to TC39 meetings. These meetings are every 2 months around the world.</li><li>If a company wants to specifically sponsor something, we can create separate issues to track. This was previously difficult because we had to pay out of pocket, or we had to find a conference on the same week to speak at to help cover expenses.</li></ul></li></ul><h3 id="how-you-can-help">How you can help!</h3><p>If your company would like to <strong>give back</strong> by supporting a fundamental part of JavaScript development and it’s future, consider donating to our <a href="https://opencollective.com/babel">Open Collective</a>. You can also donate developer time to help maintain the project.</p><h4 id="1-help-maintain-the-project-developer-time-at-work">#1 Help Maintain the Project (developer time at work)</h4><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Engineer: There&#39;s a thing in SQL Server Enterprise blocking us<br />Company: Let&#39;s set up a call next week with them an ongoing discussion to resolve it next quarter<br /><br />Engineer: There&#39;s a thing we need in babel, can I spent 2 days with a PR for it<br />Company: lol no it&#39;s their job <a href="https://t.co/icgaoJ0dTe">https://t.co/icgaoJ0dTe</a></p>&mdash; Shiya (@ShiyaLuo) <a href="https://twitter.com/ShiyaLuo/status/931230821976907776?ref_src=twsrc%5Etfw">November 16, 2017</a></blockquote><p>The best thing we can get on this project are people committed to helping out with the project given the massive amount of work/responsibility it takes. Again, <a href="https://dev.to/hzoo/im-the-maintainer-of-babel-ask-me-anything-282/comments/1k6d">I never felt ready</a> to be a maintainer but somehow stumbled upon it but I’m just one person, and our team is just a few people.</p><h4 id="2-fund-development">#2 Fund development</h4><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Company: &quot;We&#39;d like to use SQL Server Enterprise&quot;<br />MS: &quot;That&#39;ll be a quarter million dollars + $20K/month&quot;<br />Company: &quot;Ok!&quot;<br />...<br />Company: &quot;We&#39;d like to use Babel&quot;<br />Babel: &quot;Ok! npm i babel --save&quot;<br />Company: &quot;Cool&quot;<br />Babel: &quot;Would you like to help contribute financially?&quot;<br />Company: &quot;lol no&quot;</p>&mdash; Adam Rackis (@AdamRackis) <a href="https://twitter.com/AdamRackis/status/931195056479965185?ref_src=twsrc%5Etfw">November 16, 2017</a></blockquote><p>We are definetely looking to be able to fund people on the team to work full-time. Logan in particular left his job a while ago and is using our current funds to work on Babel part time at the moment!</p><h4 id="3-contribute-in-other-ways-">#3 Contribute in other ways 😊</h4><p>For example, <a href="https://twitter.com/angustweets">Angus</a> made us an <a href="https://medium.com/@angustweets/hallelujah-in-praise-of-babel-977020010fad">official song</a>!</p><h3 id="upgrading">Upgrading</h3><p>We will also be working on a upgrade tool that will help <a href="https://github.com/babel/notes/issues/44">rewrite your package.json/.babelrc files</a> and more. Ideally this means it would modify any necessary version number changes, package renames, and config changes.</p><p>Please reach out to help and to post issues when trying to update! This is a great opportunity to get involved and to help the ecosystem update!</p><h3 id="summary-of-the-previous-post">Summary of the <a href="https://babeljs.io/blog/2017/09/12/planning-for-7.0">previous post</a></h3><ul><li>Dropped Node 0.10/0.12/5 support.</li><li>Updated <a href="https://github.com/babel/proposals/issues">TC39 proposals</a><ul><li>Numeric Separator: <code class="highlighter-rouge">1_000</code></li><li>Optional Chaining Operator: <code class="highlighter-rouge">a?.b</code></li><li><code class="highlighter-rouge">import.meta</code> (parseble)</li><li>Optional Catch Binding: <code class="highlighter-rouge">try { a } catch {}</code></li><li>BigInt (parseble): <code class="highlighter-rouge">2n</code></li><li>Split export extensions into <code class="highlighter-rouge">export-default-from</code> and <code class="highlighter-rouge">export-ns-form</code></li></ul></li><li><code class="highlighter-rouge">.babelrc.js</code> support (a config using JavaScript instead of JSON)</li><li>Added a new Typescript Preset + separated the React/Flow presets<ul><li>Added <a href="https://reactjs.org/blog/2017/11/28/react-v16.2.0-fragment-support.html">JSX Fragment Support</a> and various Flow updates</li></ul></li><li>Removed the internal <code class="highlighter-rouge">babel-runtime</code> dependency for smaller size</li></ul><h3 id="newly-updated-tc39-proposals">Newly Updated TC39 Proposals</h3><ul><li>Pipeline Operator: <code class="highlighter-rouge">a |&gt; b</code></li><li>Throw Expressions: <code class="highlighter-rouge">() =&gt; throw 'hi'</code></li><li>Nullish Coalescing Operator: <code class="highlighter-rouge">a ?? b</code></li></ul><h3 id="deprecated-yearly-presets-eg-babel-preset-es20xx">Deprecated Yearly Presets (e.g. babel-preset-es20xx)</h3><p>TL;DR: use <code class="highlighter-rouge">babel-preset-env</code>.</p><p>What’s better than you having to decide which Babel preset to use? Having it done for you, automatically!</p><p>Even though the amount of work that goes into maintaining the lists of data is humongous — again, why we need help — it solves multiple issues. It makes sure users are up to date with the spec. It means less configuration/package confusion. It means an easier upgrade path. And it means less issues about what is what.</p><p><code class="highlighter-rouge">babel-preset-env</code> is actually a pretty <em>old</em> preset that replaces every other syntax preset that you will need (es2015, es2016, es2017, es20xx, latest, etc…).</p><p><a href="https://npm-stat.com/charts.html?package=babel-preset-env&amp;package=babel-preset-es2015&amp;package=babel-preset-es2016&amp;package=babel-preset-es2017&amp;package=babel-preset-latest&amp;from=2016-11-21&amp;to=2017-11-21"><img src="https://i.imgur.com/nNKKFcp.png" alt="npm presets" /></a></p><p>It compiles the latest yearly release of JavaScript (whatever is in Stage 4) which replaces all the old presets. But it also has the abilitiy to compile according to target environments you specify: whether that is for development mode, like the latest version of a browser, or for multiple builds, like a version for IE, and then another version for evergreen browsers.</p><h3 id="not-removing-the-stage-presets-babel-preset-stage-x">Not removing the Stage presets (babel-preset-stage-x)</h3><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Frustration level if we remove the Stage presets in Babel? (in favor explicitly requiring proposal plugins since they aren&#39;t JavaScript yet)</p>&mdash; Henry Zhu (@left_pad) <a href="https://twitter.com/left_pad/status/873242704364306433?ref_src=twsrc%5Etfw">June 9, 2017</a></blockquote><p>We can always keep it up to date, and maybe we just need to determine a better system than what these presets are currently.</p><p>Right now, stage presets are literally just a list of plugins that we manually update after TC39 meetings. To make this managable, we need to allow major version bumps for these “unstable” packages. Part of the reason for this is because the community will re-create these packages anyway, so we might as well do it from an official package and then have the ability to provide better messaging, etc.</p><h3 id="renames-scoped-packages-babelx">Renames: Scoped Packages (<code class="highlighter-rouge">@babel/x</code>)</h3><p>Here is a poll I did almost a year ago:</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Thoughts on <a href="https://twitter.com/babeljs">@babeljs</a> using npm scoped packages for 7.0?</p>&mdash; Henry Zhu (@left_pad) <a href="https://twitter.com/left_pad/status/821551189166878722">January 18, 2017</a></blockquote><p>Back then, not a lot of projects used scoped packages, so most people didn’t even know they existed. You may also have had to pay for a npm org account back then, while now it’s free (and supports non scoped packages, too). The issues with searching for scoped packages are solved and download counts work. The only thing left is that some 3rd party registries still don’t support scoped packages, and I think we are at a point where it seems pretty unreasonable to wait on that.</p><p>If you want reasons why we prefer scoped packages:</p><ul><li>Naming is difficult: we won’t have to check if someone else decided to use our naming convention for their own plugin</li><li>Similarly, package squatting<ul><li>Sometimes people create <code class="highlighter-rouge">babel-preset-20xx</code> or some other package because it’s funny, and then we have to make an issue/email to ask for it back.</li><li>People have a legit package, but it happens to be the same name as what we wanted to call it.  - People see that a new proposal is merging (like optional chaining, pipeline operator) and decide to fork and publish a version of it under the same name. Then, when we publish, it tell us the package was already published 🤔. Then, I have to find their email and email both them and npm support to get the package back and republish.</li></ul></li><li>What is an “official” package and what is a user/community package with the same name? We can get issue reports of people using misnamed or unofficial packages because they assumed it was part of Babel. One example of this was a report that <code class="highlighter-rouge">babel-env</code> was rewriting their <code class="highlighter-rouge">.babelrc</code> file, and it took them a while to realize it wasn’t <code class="highlighter-rouge">babel-preset-env</code>.</li></ul><p>So, it seems obvious we should use scoped packages, and, if anything, we should have done it much earlier 🙂!</p><p>Examples of the scoped name change:</p><ul><li><code class="highlighter-rouge">babel-cli</code> -&gt; <code class="highlighter-rouge">@babel/cli</code></li><li><code class="highlighter-rouge">babel-core</code> -&gt; <code class="highlighter-rouge">@babel/core</code></li><li><code class="highlighter-rouge">babel-preset-env</code> -&gt; <code class="highlighter-rouge">@babel/preset-env</code></li></ul><h3 id="renames--proposal-">Renames: <code class="highlighter-rouge">-proposal-</code></h3><p>Any proposals will be named with <code class="highlighter-rouge">-proposal-</code> now to signify that they aren’t officially in JavaScript yet.</p><p>So <code class="highlighter-rouge">@babel/plugin-transform-class-properties</code> becomes <code class="highlighter-rouge">@babel/plugin-proposal-class-properties</code>, and we would name it back once it gets into Stage 4.</p><h3 id="renames-drop-the-year-from-the-plugin-name">Renames: Drop the year from the plugin name</h3><p>Previous plugins had the year in the name, but it doesn’t seem to be necessary now.</p><p>So <code class="highlighter-rouge">@babel/plugin-transform-es2015-classes</code> becomes <code class="highlighter-rouge">@babel/plugin-transform-classes</code>.</p><p>Since years were only the case for es3/es2015, we didn’t change anything from es2016 or es2017. However, we are deprecating those presets in favor of preset-env, and, for the template literal revision, we just added it to the template literal transform for simplicity.</p><h3 id="peer-dependencies--integrations">Peer Dependencies + Integrations</h3><p>We are introducing a peer dependencies on <code class="highlighter-rouge">@babel/core</code> for all the plugins (<code class="highlighter-rouge">@babel/plugin-class-properties</code>), presets (<code class="highlighter-rouge">@babel/preset-env</code>), and top level packages (<code class="highlighter-rouge">@babel/cli</code>, <code class="highlighter-rouge">babel-loader</code>).</p><blockquote><p>peerDependencies are dependencies expected to be used by your code, as opposed to dependencies only used as an implementation detail. — <a href="https://stackoverflow.com/a/34645112">Stijn de Witt via StackOverflow</a>.</p></blockquote><p><code class="highlighter-rouge">babel-loader</code> already had a <code class="highlighter-rouge">peerDependency</code> on <code class="highlighter-rouge">babel-core</code>, so this just changes it to <code class="highlighter-rouge">@babel/core</code>. This is just so that people weren’t trying to install these packages on the wrong version of Babel.</p><p>For tools that already have a <code class="highlighter-rouge">peerDependency</code> on <code class="highlighter-rouge">babel-core</code> and aren’t ready for a major bump (since changing the peer dependency is a breaking change), we have published a new version of <code class="highlighter-rouge">babel-core</code> to bridge the changes over with the new version <a href="https://github.com/babel/babel-bridge">babel-core@7.0.0-bridge.0</a>. For more information check out <a href="https://github.com/facebook/jest/pull/4557#issuecomment-344048628">this issue</a>.</p><p>Similarly, packages like <code class="highlighter-rouge">gulp-babel</code>, <code class="highlighter-rouge">rollup-plugin-babel</code>, etc, all used to have <code class="highlighter-rouge">babel-core</code> as a dependency. Now these will just have a <code class="highlighter-rouge">peerDependency</code> on <code class="highlighter-rouge">@babel/core</code>. This lets these packages not have to bump major versions when the <code class="highlighter-rouge">@babel/core</code> API hasn’t changed.</p><h3 id="5224-independent-publishing-of-experimental-packages"><a href="https://github.com/babel/babel/pull/5224">#5224</a> Independent Publishing of Experimental Packages</h3><blockquote><p>I mention this in <a href="http://babeljs.io/blog/2016/12/07/the-state-of-babel">The State of Babel</a> in the <code class="highlighter-rouge">Versioning</code> section. <a href="https://github.com/babel/babylon/issues/275">Github Issue</a></p></blockquote><p>You might remember that after Babel 6, Babel became a set of npm packages with its own ecosystem of custom presets and plugins.</p><p>However since then, we have always used a “fixed/synchronized” versioning system (so that no package is on v7.0 or above). When we do a new release such as <code class="highlighter-rouge">v6.23.0</code> only packages that have updated code in the source are published with the new version while the rest of the packages are left as is. This mostly works in practice because we use <code class="highlighter-rouge">^</code> in our packages.</p><p>Unfortunately this kind of system requires that a major version be released for all packages once a single package needs it. This either means we make a lot small breaking changes (unnecessary), or we batch lots of breaking changes into a single release. Instead, we want to differentiate between the experimental packages (Stage 0, etc.) and everything else (es2015).</p><p>This means we intend to make major version bumps to any experimental proposal plugins when the spec changes rather than waiting to update all of Babel. So anything that is &lt; Stage 4 would be open to breaking changes in the form of major version bumps and same with the Stage presets themselves (if we don’t drop them entirely).</p><p>This goes with our decision to change TC39 proposal plugins to use the <code class="highlighter-rouge">-proposal-</code> name. If the spec changes, we will do a major version bump to the plugin and the preset it belongs to (as opposed to just making a patch version which may break for people). Then, we will need to deprecate the old versions and setup an infrastructure to automatically update people so that everyone is up to date on what the spec will become (and so they don’t get stuck on something, like we have with decorators).</p><h3 id="the-env-option-in-babelrc-is-not-being-deprecated">The <code class="highlighter-rouge">env</code> option in <code class="highlighter-rouge">.babelrc</code> is not being deprecated!</h3><p>Unlike in the <a href="https://babeljs.io/blog/2017/09/12/planning-for-7.0#deprecate-the-env-option-in-babelrc">last post</a>, we just fixed the merging behavior to be <a href="https://twitter.com/left_pad/status/936687774098444288">more consistent</a>.</p><p>The configuration in <code class="highlighter-rouge">env</code> is given higher priority than root config items, and instead of just being a weird approach of using both, plugins and presets now merge based on their identity, so you can do</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">presets</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">'env'</span><span class="p">,</span> <span class="p">{</span> <span class="na">modules</span><span class="p">:</span> <span class="kc">false</span><span class="p">}],</span>
  <span class="p">],</span>
  <span class="nx">env</span><span class="err">:</span> <span class="p">{</span>
    <span class="nl">test</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">presets</span><span class="p">:</span> <span class="p">[</span>
         <span class="s1">'env'</span>
      <span class="p">],</span>
    <span class="p">}</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div><p>with <code class="highlighter-rouge">BABEL_ENV=test</code>, which would replace the root env config, with the one from test, which has no options.</p><h3 id="support-class-a-extends-array-oldest-caveat"><a href="https://twitter.com/left_pad/status/940723982638157829">Support <code class="highlighter-rouge">class A extends Array</code> (oldest caveat)</a></h3><p>Babel will automatically wrap any native built-ins like <code class="highlighter-rouge">Array</code>, <code class="highlighter-rouge">Error</code>, <code class="highlighter-rouge">HTMLElement</code> etc so that doing this just works when compiling classes.</p><h3 id="speed">Speed</h3><ul><li>Many <a href="https://twitter.com/rauchg/status/924349334346276864">fixes</a> from <a href="https://twitter.com/bmeurer">bmeurer</a> on the v8 team!</li><li>60% faster via the <a href="https://github.com/v8/web-tooling-benchmark">web-tooling-benchmark</a> https://twitter.com/left_pad/status/927554660508028929</li></ul><h3 id="preset-env-usebuiltins-usage">preset-env: <code class="highlighter-rouge">"useBuiltins": "usage"</code></h3><p><code class="highlighter-rouge">babel-preset-env</code> introduced the idea of compiling syntax to different targets and via the <code class="highlighter-rouge">useBuiltIns</code> option, the ability to also only add polyfills that the targets don’t support.</p><p>So with this option, something like:</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="s2">"babel-polyfill"</span><span class="p">;</span>
</code></pre></div><p>Can turn into</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="s2">"core-js/modules/es7.string.pad-start"</span><span class="p">;</span>
<span class="kr">import</span> <span class="s2">"core-js/modules/es7.string.pad-end"</span><span class="p">;</span>
<span class="c1">// ...</span>
</code></pre></div><p>if the target environment happens to support polyfills other than <code class="highlighter-rouge">padStart</code> or <code class="highlighter-rouge">padEnd</code>.</p><p>However in order to make that even better, we should only import polyfills that are “used” in the codebase itself. Why even import <code class="highlighter-rouge">padStart</code> if it’s not even used in the code?</p><p><code class="highlighter-rouge">"useBuiltins": "usage"</code> is our first attempt to begin that idea. It does an import at the top of each file but only adds the import if it finds it used in the code. This approach means that we can import the minimum amount of polyfills necessary for the app (and only if the target environment doesn’t support it).</p><p>So if you use <code class="highlighter-rouge">Promise</code> in your code, it will import it at the top of the file (if your target doesn’t support it). Bundlers will dedupe the file if it’s the same so this approach won’t cause multiple polyfills to be imported.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="s2">"core-js/modules/es6.promise"</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Promise</span><span class="p">();</span>
</code></pre></div><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">import</span> <span class="s2">"core-js/modules/es7.array.includes"</span><span class="p">;</span>
<span class="p">[].</span><span class="nx">includes</span>
<span class="nx">a</span><span class="p">.</span><span class="nx">includes</span>
</code></pre></div><p>With type inference we can know if an instance method like <code class="highlighter-rouge">.includes</code> is for an array or not, and having a false positive is ok until that logic is better since it’s still better than importing the whole polyfill like before.</p><h3 id="misc-updates">Misc Updates</h3><ul><li><a href="https://github.com/babel/babel/blob/master/packages/babel-template"><code class="highlighter-rouge">babel-template</code></a> is faster/easier to use</li><li><a href="https://github.com/facebook/regenerator">regenerator</a> was released under the <a href="https://twitter.com/left_pad/status/938825429955125248">MIT License</a> - it’s the dependency used to compile generators/async</li><li>“lazy” option to the <code class="highlighter-rouge">modules-commonjs</code> plugin via <a href="https://github.com/babel/babel/pull/6952">#6952</a></li><li>You can now use <code class="highlighter-rouge">envName: "something"</code> in .babelrc or pass via cli <code class="highlighter-rouge">babel --envName=something</code> instead of having to use <code class="highlighter-rouge">process.env.BABEL_ENV</code> or <code class="highlighter-rouge">process.env.NODE_ENV</code></li><li><code class="highlighter-rouge">["transform-for-of", { "assumeArray": true }]</code> to make all for-of loops output as regular arrays</li><li>Exclude <code class="highlighter-rouge">transform-typeof-symbol</code> in loose mode for preset-env <a href="https://github.com/babel/babel/pull/6831">#6831</a></li><li><a href="https://twitter.com/left_pad/status/942859244759666691">Landed PR for better error messages with syntax errors</a></li></ul><h3 id="todos-before-release">Todos Before Release</h3><ul><li><a href="https://github.com/babel/babel/issues/6766">Handle <code class="highlighter-rouge">.babelrc</code> lookup</a> (want this done before first RC release)</li><li><a href="https://github.com/babel/babel/pull/7091">“overrides” support</a>: different config based on glob pattern</li><li>Caching and invalidation logic in babel-core.</li><li>Better story around external helpers.</li><li>Either implement or have plan in place for versioning and handling polyfills independently from helpers, so we aren’t explicitly tied to core-js 2 or 3, since people may have things that depend on one or the other and won’t want to load both a lot of the time.</li><li>Either a <a href="https://github.com/babel/babel/pull/6107">working decorator implementation</a>, or functional legacy implementation, with clear path to land current spec behavior during 7.x’s lifetime.</li></ul><h3 id="thanks">Thanks</h3><p>Shoutout to our team of volunteers: <a href="https://twitter.com/loganfsmyth">Logan</a> who has been really pushing hard to fix a lot of our core issues regarding configs and more and the one doing all of that hard work, <a href="https://twitter.com/existentialism">Brian</a> who has been taking over maintainence of a lot of preset-env work and just whatever I was doing before 😛, and <a href="https://twitter.com/TschinderDaniel">Daniel</a> who has always been stepping in when we need the help whether it be maintaining babel-loader or helping move the babylon/babel-preset-env repo’s over. And same with <a href="https://twitter.com/NicoloRibaudo">Nicolo</a>, <a href="https://twitter.com/svensauleau">Sven</a>, <a href="https://twitter.com/yavorsky_">Artem</a>, and <a href="https://twitter.com/kovnsk">Diogo</a> for stepping up in the last year to help out.</p><p>I’m really looking forward to a release (I’m tired too; it’s almost been a year 😝), but also don’t want to rush anything just because! Been a lot of ups and downs throughout this release but I’ve certainly learned a lot and I’m sure the rest of the team has as well.</p><p>And if I’ve learned anything at all this year, I should really heed this advice rather than just write about it.</p><blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">&quot;Before you go maintaining anything else, maintain your own body first&quot; - Mom 😸</p>&mdash; Henry Zhu (@left_pad) <a href="https://twitter.com/left_pad/status/944313617243099136?ref_src=twsrc%5Etfw">December 22, 2017</a></blockquote><blockquote><p>Also thanks to <a href="https://twitter.com/kosamari">Mariko</a> for the <a href="https://twitter.com/kosamari/status/944272286055530496">light push</a> to actually finish this post (2 months in the making)</p></blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div></div></div><div class="footer text-center"><p><a href="https://github.com/docschina/babeljs.io">Babel中文网</a> · <a href="https://github.com/docschina/babeljs.io/blob/cn/LICENSE">遵循 CC-BY-4.0 许可协议</a> · <a href="https://github.com/babel/babel/blob/master/CODE_OF_CONDUCT.md">代码规范</a></p><p><a href="http://henryzoo.com/babel.github.io/">查看 Babel 5.x 文档?</a> · 发现文档中的问题，提交到 <a href="https://github.com/docschina/babeljs.io/issues/new">这里</a>.</p><p>特别鸣谢 <a href="https://cloud.tencent.com/">腾讯云</a> · <a href="http://www.bootcss.com/">Bootstrap中文网</a> 提供服务和支持</p><br/><p><a href=" " target="_blank">冀ICP备14002930号</a></p></div><script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js' defer></script> <script src='https://cdn.bootcss.com/lodash.js/4.16.3/lodash.min.js' defer></script> <script src='https://cdn.bootcss.com/bootstrap/3.3.1/js/bootstrap.min.js' defer></script> <script src='https://cdn.bootcss.com/clipboard.js/1.5.13/clipboard.min.js' defer></script> <script src='https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js' defer></script> <script src='/scripts/search.js?v=1' defer></script> <script src='/scripts/clipboard.js' defer></script> <script src='/scripts/open-in-repl.js' defer></script> <script> document.addEventListener('DOMContentLoaded', function() { $("html").removeClass("no-js").addClass("js"); }); </script></body></html>
